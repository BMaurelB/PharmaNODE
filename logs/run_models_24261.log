/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 3000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 50 --experiment 24261
Experiment 24261
Epoch 1000 [Test seq (cond on sampled tp)] | Loss 144.595947 | Likelihood -142.958832 | KL fp 4.4263 | FP STD 0.0732|
KL coef: 0.9999522643707747
Train loss (one batch): 152.3850860595703
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0293
Test MSE (smoothed with alpha=0.01): 0.0293
New best smoothed test MSE: 0.0293. Saving best model to experiments/experiment_24261_best.ckpt
Test MSE group_0: 0.0271
Test MSE group_1: 0.0315
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0296
train MSE group_1: 0.0316
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24261
Epoch 2000 [Test seq (cond on sampled tp)] | Loss 149.711441 | Likelihood -149.071732 | KL fp 4.0241 | FP STD 0.1515|
KL coef: 0.9999999979391934
Train loss (one batch): 154.13967895507812
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0306
Test MSE (smoothed with alpha=0.01): 0.0293
Smoothed Test MSE did not improve. Early stopping counter: 1/10000
Test MSE group_0: 0.0283
Test MSE group_1: 0.0327
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0297
train MSE group_1: 0.0324
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24261
Epoch 3000 [Test seq (cond on sampled tp)] | Loss 141.774612 | Likelihood -140.147614 | KL fp 4.2893 | FP STD 0.0994|
KL coef: 0.9999999999999111
Train loss (one batch): 144.25274658203125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0288
Test MSE (smoothed with alpha=0.01): 0.0293
Smoothed Test MSE did not improve. Early stopping counter: 2/10000
Test MSE group_0: 0.0267
Test MSE group_1: 0.0308
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0282
train MSE group_1: 0.0299
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
