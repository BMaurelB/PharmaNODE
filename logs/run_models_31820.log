/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 5000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 31820
Experiment 31820
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 1913.756348 | Likelihood -2046.418579 | KL fp 1.9698 | FP STD 0.5468|
KL coef: 0.0
Train loss (one batch): 2395.277587890625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.4100
Test MSE (smoothed with alpha=0.01): 0.4100
New best smoothed test MSE: 0.4100. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.4754
Test MSE group_1: 0.3446
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.5728
train MSE group_1: 0.3800
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 697.506836 | Likelihood -743.446167 | KL fp 3.5256 | FP STD 0.2674|
KL coef: 0.09561792499119559
Train loss (one batch): 739.9379272460938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1494
Test MSE (smoothed with alpha=0.01): 0.4074
New best smoothed test MSE: 0.4074. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.1792
Test MSE group_1: 0.1196
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1474
train MSE group_1: 0.1530
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 589.303101 | Likelihood -613.961365 | KL fp 4.7918 | FP STD 0.2517|
KL coef: 0.18209306240276923
Train loss (one batch): 664.478515625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1235
Test MSE (smoothed with alpha=0.01): 0.4046
New best smoothed test MSE: 0.4046. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.1413
Test MSE group_1: 0.1058
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1165
train MSE group_1: 0.1556
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 403.545074 | Likelihood -424.604248 | KL fp 4.0718 | FP STD 0.2242|
KL coef: 0.2602996266117198
Train loss (one batch): 436.04949951171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0857
Test MSE (smoothed with alpha=0.01): 0.4014
New best smoothed test MSE: 0.4014. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.1067
Test MSE group_1: 0.0646
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0980
train MSE group_1: 0.0767
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 282.376068 | Likelihood -297.404694 | KL fp 4.5712 | FP STD 0.1817|
KL coef: 0.3310282414303197
Train loss (one batch): 265.5878601074219
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0602
Test MSE (smoothed with alpha=0.01): 0.3980
New best smoothed test MSE: 0.3980. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.0622
Test MSE group_1: 0.0583
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0532
train MSE group_1: 0.0624
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 236.256638 | Likelihood -241.012039 | KL fp 4.4088 | FP STD 0.1572|
KL coef: 0.39499393286246365
Train loss (one batch): 213.84149169921875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0489
Test MSE (smoothed with alpha=0.01): 0.3945
New best smoothed test MSE: 0.3945. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.0489
Test MSE group_1: 0.0490
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0340
train MSE group_1: 0.0549
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 207.635590 | Likelihood -211.306183 | KL fp 4.6655 | FP STD 0.1350|
KL coef: 0.4528433576092388
Train loss (one batch): 198.53663635253906
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0430
Test MSE (smoothed with alpha=0.01): 0.3910
New best smoothed test MSE: 0.3910. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.0416
Test MSE group_1: 0.0443
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0291
train MSE group_1: 0.0533
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
