/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 3000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 39673
Experiment 39673
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 2494.343750 | Likelihood -2515.433594 | KL fp 4.0417 | FP STD 0.4009|
KL coef: 0.0
Train loss (one batch): 1752.8394775390625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.5038
Test MSE (smoothed with alpha=0.01): 0.5038
New best smoothed test MSE: 0.5038. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.4659
Test MSE group_1: 0.5472
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.3496
train MSE group_1: 0.3561
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 756.511902 | Likelihood -781.164917 | KL fp 4.4296 | FP STD 0.5104|
KL coef: 0.09561792499119559
Train loss (one batch): 739.613525390625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1570
Test MSE (smoothed with alpha=0.01): 0.5004
New best smoothed test MSE: 0.5004. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.1330
Test MSE group_1: 0.1843
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1330
train MSE group_1: 0.1729
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 677.012207 | Likelihood -693.661743 | KL fp 4.4909 | FP STD 0.5005|
KL coef: 0.18209306240276923
Train loss (one batch): 672.5155639648438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1395
Test MSE (smoothed with alpha=0.01): 0.4967
New best smoothed test MSE: 0.4967. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.1121
Test MSE group_1: 0.1708
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1228
train MSE group_1: 0.1508
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 669.792480 | Likelihood -686.994995 | KL fp 4.5144 | FP STD 0.4898|
KL coef: 0.2602996266117198
Train loss (one batch): 627.9193115234375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1381
Test MSE (smoothed with alpha=0.01): 0.4932
New best smoothed test MSE: 0.4932. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.1049
Test MSE group_1: 0.1761
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1033
train MSE group_1: 0.1563
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 634.562378 | Likelihood -652.000732 | KL fp 4.7885 | FP STD 0.3774|
KL coef: 0.3310282414303197
Train loss (one batch): 602.4717407226562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1311
Test MSE (smoothed with alpha=0.01): 0.4895
New best smoothed test MSE: 0.4895. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.1007
Test MSE group_1: 0.1659
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1016
train MSE group_1: 0.1462
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 639.699463 | Likelihood -649.084961 | KL fp 4.7898 | FP STD 0.3460|
KL coef: 0.39499393286246365
Train loss (one batch): 580.9243774414062
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1306
Test MSE (smoothed with alpha=0.01): 0.4860
New best smoothed test MSE: 0.4860. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.1015
Test MSE group_1: 0.1638
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0986
train MSE group_1: 0.1390
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 627.888611 | Likelihood -637.661743 | KL fp 4.7610 | FP STD 0.3247|
KL coef: 0.4528433576092388
Train loss (one batch): 579.7501220703125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1283
Test MSE (smoothed with alpha=0.01): 0.4824
New best smoothed test MSE: 0.4824. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.1007
Test MSE group_1: 0.1598
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0984
train MSE group_1: 0.1387
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0080 [Test seq (cond on sampled tp)] | Loss 613.766968 | Likelihood -628.529297 | KL fp 4.6786 | FP STD 0.3580|
KL coef: 0.505161340399793
Train loss (one batch): 555.2593994140625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1264
Test MSE (smoothed with alpha=0.01): 0.4788
New best smoothed test MSE: 0.4788. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0985
Test MSE group_1: 0.1584
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0950
train MSE group_1: 0.1341
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0090 [Test seq (cond on sampled tp)] | Loss 612.855835 | Likelihood -623.708252 | KL fp 4.7721 | FP STD 0.3447|
KL coef: 0.5524767862361895
Train loss (one batch): 563.6676025390625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1255
Test MSE (smoothed with alpha=0.01): 0.4753
New best smoothed test MSE: 0.4753. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0964
Test MSE group_1: 0.1588
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0940
train MSE group_1: 0.1399
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0100 [Test seq (cond on sampled tp)] | Loss 600.489746 | Likelihood -606.972961 | KL fp 4.8410 | FP STD 0.2848|
KL coef: 0.5952680273216762
Train loss (one batch): 556.5512084960938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1221
Test MSE (smoothed with alpha=0.01): 0.4717
New best smoothed test MSE: 0.4717. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0981
Test MSE group_1: 0.1497
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0981
train MSE group_1: 0.1280
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0110 [Test seq (cond on sampled tp)] | Loss 587.593323 | Likelihood -598.669312 | KL fp 4.7590 | FP STD 0.2839|
KL coef: 0.6339676587267709
Train loss (one batch): 543.2732543945312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1205
Test MSE (smoothed with alpha=0.01): 0.4682
New best smoothed test MSE: 0.4682. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0937
Test MSE group_1: 0.1511
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0905
train MSE group_1: 0.1304
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0120 [Test seq (cond on sampled tp)] | Loss 567.490479 | Likelihood -576.706543 | KL fp 4.7963 | FP STD 0.2643|
KL coef: 0.6689669116789861
Train loss (one batch): 534.5584106445312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1161
Test MSE (smoothed with alpha=0.01): 0.4647
New best smoothed test MSE: 0.4647. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0902
Test MSE group_1: 0.1457
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0895
train MSE group_1: 0.1272
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0130 [Test seq (cond on sampled tp)] | Loss 537.250977 | Likelihood -549.172363 | KL fp 4.6116 | FP STD 0.2887|
KL coef: 0.7006196086876687
Train loss (one batch): 500.362548828125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1106
Test MSE (smoothed with alpha=0.01): 0.4612
New best smoothed test MSE: 0.4612. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0879
Test MSE group_1: 0.1366
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0852
train MSE group_1: 0.1174
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0140 [Test seq (cond on sampled tp)] | Loss 441.407196 | Likelihood -452.689697 | KL fp 4.3954 | FP STD 0.2942|
KL coef: 0.729245740488006
Train loss (one batch): 439.2882995605469
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0913
Test MSE (smoothed with alpha=0.01): 0.4575
New best smoothed test MSE: 0.4575. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0777
Test MSE group_1: 0.1070
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0802
train MSE group_1: 0.1001
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0150 [Test seq (cond on sampled tp)] | Loss 333.446716 | Likelihood -344.319397 | KL fp 4.3539 | FP STD 0.2796|
KL coef: 0.7551347009650705
Train loss (one batch): 324.0051574707031
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0696
Test MSE (smoothed with alpha=0.01): 0.4536
New best smoothed test MSE: 0.4536. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0558
Test MSE group_1: 0.0853
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0574
train MSE group_1: 0.0750
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 39673
Epoch 0160 [Test seq (cond on sampled tp)] | Loss 277.283569 | Likelihood -282.122864 | KL fp 4.4585 | FP STD 0.2823|
KL coef: 0.7785482127611391
Train loss (one batch): 332.58966064453125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0572
Test MSE (smoothed with alpha=0.01): 0.4496
New best smoothed test MSE: 0.4496. Saving best model to experiments/experiment_39673_best.ckpt
Test MSE group_0: 0.0466
Test MSE group_1: 0.0692
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0598
train MSE group_1: 0.0762
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
