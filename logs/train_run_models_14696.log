/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:159: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df = df.applymap(lambda x: str(x).replace(",", ".") if isinstance(x, str) else x)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:267: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/miniforge3/conda-bld/libtorch_1744320385493/work/torch/csrc/utils/tensor_new.cpp:281.)
  'auc_be': torch.tensor(auc_be),
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:391: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df = df.applymap(lambda x: str(x).replace(",", ".") if isinstance(x, str) else x)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:391: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df = df.applymap(lambda x: str(x).replace(",", ".") if isinstance(x, str) else x)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 10 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 53 --experiment 14696
Experiment 14696
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 5474.732422 | Likelihood -5771.376953 | KL fp 4.0735 | FP STD 1.7116|
KL coef: 0.0
Train loss (one batch): 6378.43505859375
Train CE loss (one batch): 0.0
Test MSE (raw): 1.1550
Test MSE (smoothed with alpha=0.01): 1.1550
New best smoothed test MSE: 1.1550. Saving best model to experiments/experiment_14696_best.ckpt
Test MSE group_0: 1.4894
Test MSE group_1: 1.0587
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 2.0929
train MSE group_1: 1.1612
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['3411', '1441', '3450', '1841', '11541', '3121', '1750', '3111', '11031', '1821', '31051', '1711', '11151', '11141', '2251', '1141', '1941', '2311', '1950', '1831', '550', '3831', '2511', '2441', '1850', '3321', '11631', '11741', '2750', '11051', '3650', '11241', '1050', '850', '3150', '1531', '11451', '1311', '3151', '1521', '3731', '2650', '1131', '2541', '1150', '2350', '3651', '2231', '2331', '2451', '3631', '1931', '3421', '4050', '1911', '3311', '11511', '1421', '2241', '11251', '11711', '3950', '1321', '3351', '650', '150', '2121', '3841', '11721', '1921', '2551', '1641', '11411', '1231', '3350', '3911', '1151', '1551', '3221', '2131', '1250', '2111', '1211', '1741', '11441', '3541', '3211', '11311', '1450', '1331', '3951', '11531', '3741', '11751', '1751', '3751', '31031', '1611', '2411', '1111', '31041', '3531', '11431', '11121', '11341', '11651', '3750', '3931', '1550', '3131', '3050', '11211', '3550', '1650', '950', '2421', '2521', '3521', '11421', '11731', '1811', '2141', '3851', '250', '3250', '2050', '3241', '2221', '11641', '11611', '3821', '1350', '2850', '1541', '4250', '1121', '3941', '11231', '1721', '11621', '2211', '1221', '11131', '11111', '750', '2250', '3331', '3141', '3231', '31021', '1511', '3811']
177
TensorBoard logs will be saved to: experiments/runs/14696
Training complete. TensorBoard writer closed.
Best model (based on smoothed MSE) saved to experiments/experiment_14696_best.ckpt with smoothed Test MSE: 1.1550
