/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 3000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 15022
Experiment 15022
Epoch 1000 [Test seq (cond on sampled tp)] | Loss 286.474579 | Likelihood -289.279877 | KL fp 5.8121 | FP STD 0.1189|
KL coef: 0.9999522643707747
Train loss (one batch): 235.6627960205078
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0586
Test MSE (smoothed with alpha=0.01): 0.0586
New best smoothed test MSE: 0.0586. Saving best model to experiments/experiment_15022_best.ckpt
Test MSE group_0: 0.0531
Test MSE group_1: 0.0641
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0425
train MSE group_1: 0.0613
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 15022
Epoch 2000 [Test seq (cond on sampled tp)] | Loss 286.953247 | Likelihood -286.522736 | KL fp 5.7754 | FP STD 0.1273|
KL coef: 0.9999999979391934
Train loss (one batch): 210.22752380371094
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0580
Test MSE (smoothed with alpha=0.01): 0.0586
New best smoothed test MSE: 0.0586. Saving best model to experiments/experiment_15022_best.ckpt
Test MSE group_0: 0.0524
Test MSE group_1: 0.0637
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0363
train MSE group_1: 0.0535
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 15022
Epoch 3000 [Test seq (cond on sampled tp)] | Loss 290.321777 | Likelihood -291.031555 | KL fp 5.2831 | FP STD 0.1309|
KL coef: 0.9999999999999111
Train loss (one batch): 195.42971801757812
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0589
Test MSE (smoothed with alpha=0.01): 0.0586
Smoothed Test MSE did not improve. Early stopping counter: 1/10000
Test MSE group_0: 0.0558
Test MSE group_1: 0.0620
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0356
train MSE group_1: 0.0479
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '100']
100
TensorBoard logs will be saved to: experiments/runs/15022
Training complete. TensorBoard writer closed.
Best model (based on smoothed MSE) saved to experiments/experiment_15022_best.ckpt with smoothed Test MSE: 0.0586
