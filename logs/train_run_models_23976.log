/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 10 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 50 --experiment 23976
Experiment 23976
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 1257.823364 | Likelihood -1587.747314 | KL fp 2.8835 | FP STD 0.5253|
KL coef: 0.0
Train loss (one batch): 2719.7666015625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.3183
Test MSE (smoothed with alpha=0.01): 0.3183
New best smoothed test MSE: 0.3183. Saving best model to experiments/experiment_23976_best.ckpt
Test MSE group_0: 0.1690
Test MSE group_1: 0.5250
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.5254
train MSE group_1: 0.6276
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['13', '1', '160', '47', '2', '81', '40', '21', '116', '121', '50', '9', '117', '153', '161', '87', '83', '125', '24', '142', '89', '163', '197', '82', '120', '200', '65', '171', '29', '182', '72']
151
TensorBoard logs will be saved to: experiments/runs/23976
Training complete. TensorBoard writer closed.
Best model (based on smoothed MSE) saved to experiments/experiment_23976_best.ckpt with smoothed Test MSE: 0.3183
