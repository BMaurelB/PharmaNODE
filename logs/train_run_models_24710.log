/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 5000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 24710
Experiment 24710
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 1186.743896 | Likelihood -1260.391602 | KL fp 2.6384 | FP STD 0.4280|
KL coef: 0.0
Train loss (one batch): 1867.6356201171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.2528
Test MSE (smoothed with alpha=0.01): 0.2528
New best smoothed test MSE: 0.2528. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.2685
Test MSE group_1: 0.2288
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.4781
train MSE group_1: 0.3002
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 729.019531 | Likelihood -768.684021 | KL fp 3.2991 | FP STD 0.5857|
KL coef: 0.09561792499119559
Train loss (one batch): 960.11767578125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1545
Test MSE (smoothed with alpha=0.01): 0.2518
New best smoothed test MSE: 0.2518. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1773
Test MSE group_1: 0.1194
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1805
train MSE group_1: 0.2169
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 633.385742 | Likelihood -660.157532 | KL fp 4.0063 | FP STD 0.3893|
KL coef: 0.18209306240276923
Train loss (one batch): 835.212890625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1328
Test MSE (smoothed with alpha=0.01): 0.2506
New best smoothed test MSE: 0.2506. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1460
Test MSE group_1: 0.1124
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1483
train MSE group_1: 0.1932
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 680.626587 | Likelihood -688.767212 | KL fp 4.2260 | FP STD 0.2866|
KL coef: 0.2602996266117198
Train loss (one batch): 801.6181030273438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1385
Test MSE (smoothed with alpha=0.01): 0.2495
New best smoothed test MSE: 0.2495. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1557
Test MSE group_1: 0.1120
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1484
train MSE group_1: 0.1730
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 677.045288 | Likelihood -707.658203 | KL fp 4.3290 | FP STD 0.3256|
KL coef: 0.3310282414303197
Train loss (one batch): 781.2108764648438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1423
Test MSE (smoothed with alpha=0.01): 0.2484
New best smoothed test MSE: 0.2484. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1603
Test MSE group_1: 0.1145
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1507
train MSE group_1: 0.1683
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 651.624573 | Likelihood -688.471802 | KL fp 4.1903 | FP STD 0.3379|
KL coef: 0.39499393286246365
Train loss (one batch): 766.4017333984375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1384
Test MSE (smoothed with alpha=0.01): 0.2473
New best smoothed test MSE: 0.2473. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1539
Test MSE group_1: 0.1147
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1492
train MSE group_1: 0.1630
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 666.322815 | Likelihood -693.966431 | KL fp 4.4349 | FP STD 0.2839|
KL coef: 0.4528433576092388
Train loss (one batch): 788.70849609375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1395
Test MSE (smoothed with alpha=0.01): 0.2463
New best smoothed test MSE: 0.2463. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1558
Test MSE group_1: 0.1145
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1520
train MSE group_1: 0.1655
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0080 [Test seq (cond on sampled tp)] | Loss 655.884583 | Likelihood -674.804504 | KL fp 4.5333 | FP STD 0.2350|
KL coef: 0.505161340399793
Train loss (one batch): 750.648193359375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1357
Test MSE (smoothed with alpha=0.01): 0.2452
New best smoothed test MSE: 0.2452. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1492
Test MSE group_1: 0.1149
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1467
train MSE group_1: 0.1591
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0090 [Test seq (cond on sampled tp)] | Loss 627.730591 | Likelihood -662.397400 | KL fp 4.0725 | FP STD 0.3019|
KL coef: 0.5524767862361895
Train loss (one batch): 734.9095458984375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1332
Test MSE (smoothed with alpha=0.01): 0.2440
New best smoothed test MSE: 0.2440. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1471
Test MSE group_1: 0.1118
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1401
train MSE group_1: 0.1565
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0100 [Test seq (cond on sampled tp)] | Loss 571.704590 | Likelihood -589.713074 | KL fp 4.2449 | FP STD 0.2353|
KL coef: 0.5952680273216762
Train loss (one batch): 643.6214599609375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1187
Test MSE (smoothed with alpha=0.01): 0.2428
New best smoothed test MSE: 0.2428. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1276
Test MSE group_1: 0.1050
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1220
train MSE group_1: 0.1364
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0110 [Test seq (cond on sampled tp)] | Loss 441.095398 | Likelihood -462.877380 | KL fp 4.2510 | FP STD 0.3675|
KL coef: 0.6339676587267709
Train loss (one batch): 533.0277709960938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0933
Test MSE (smoothed with alpha=0.01): 0.2413
New best smoothed test MSE: 0.2413. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1013
Test MSE group_1: 0.0811
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1015
train MSE group_1: 0.1127
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0120 [Test seq (cond on sampled tp)] | Loss 513.444519 | Likelihood -550.998169 | KL fp 3.5948 | FP STD 0.3870|
KL coef: 0.6689669116789861
Train loss (one batch): 432.23907470703125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1109
Test MSE (smoothed with alpha=0.01): 0.2400
New best smoothed test MSE: 0.2400. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0781
Test MSE group_1: 0.1615
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0858
train MSE group_1: 0.0922
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0130 [Test seq (cond on sampled tp)] | Loss 332.494568 | Likelihood -349.287262 | KL fp 4.4826 | FP STD 0.2702|
KL coef: 0.7006196086876687
Train loss (one batch): 536.1255493164062
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0706
Test MSE (smoothed with alpha=0.01): 0.2383
New best smoothed test MSE: 0.2383. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0783
Test MSE group_1: 0.0587
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0909
train MSE group_1: 0.1258
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0140 [Test seq (cond on sampled tp)] | Loss 289.164032 | Likelihood -301.074921 | KL fp 3.7991 | FP STD 0.3240|
KL coef: 0.729245740488006
Train loss (one batch): 370.90399169921875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0610
Test MSE (smoothed with alpha=0.01): 0.2365
New best smoothed test MSE: 0.2365. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0526
Test MSE group_1: 0.0738
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0598
train MSE group_1: 0.0885
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0150 [Test seq (cond on sampled tp)] | Loss 254.178894 | Likelihood -259.188354 | KL fp 4.4837 | FP STD 0.2772|
KL coef: 0.7551347009650705
Train loss (one batch): 303.2833557128906
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0526
Test MSE (smoothed with alpha=0.01): 0.2347
New best smoothed test MSE: 0.2347. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0518
Test MSE group_1: 0.0538
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0501
train MSE group_1: 0.0744
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0160 [Test seq (cond on sampled tp)] | Loss 249.593628 | Likelihood -254.251190 | KL fp 4.6667 | FP STD 0.2750|
KL coef: 0.7785482127611391
Train loss (one batch): 312.2873229980469
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0516
Test MSE (smoothed with alpha=0.01): 0.2329
New best smoothed test MSE: 0.2329. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0479
Test MSE group_1: 0.0573
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0495
train MSE group_1: 0.0748
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0170 [Test seq (cond on sampled tp)] | Loss 232.871384 | Likelihood -241.406128 | KL fp 3.8768 | FP STD 0.3099|
KL coef: 0.7997229731425107
Train loss (one batch): 337.0905456542969
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0490
Test MSE (smoothed with alpha=0.01): 0.2310
New best smoothed test MSE: 0.2310. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0408
Test MSE group_1: 0.0617
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0566
train MSE group_1: 0.0783
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0180 [Test seq (cond on sampled tp)] | Loss 595.464417 | Likelihood -642.606140 | KL fp 3.0509 | FP STD 0.5548|
KL coef: 0.8188730468740297
Train loss (one batch): 930.4520874023438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1293
Test MSE (smoothed with alpha=0.01): 0.2300
New best smoothed test MSE: 0.2300. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1378
Test MSE group_1: 0.1161
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.2085
train MSE group_1: 0.1695
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0190 [Test seq (cond on sampled tp)] | Loss 627.850952 | Likelihood -665.819946 | KL fp 2.9999 | FP STD 0.6014|
KL coef: 0.8361920302919126
Train loss (one batch): 713.6930541992188
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1339
Test MSE (smoothed with alpha=0.01): 0.2290
New best smoothed test MSE: 0.2290. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1445
Test MSE group_1: 0.1176
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1329
train MSE group_1: 0.1545
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0200 [Test seq (cond on sampled tp)] | Loss 495.740784 | Likelihood -510.485107 | KL fp 4.0223 | FP STD 0.4802|
KL coef: 0.8518550084524206
Train loss (one batch): 635.6476440429688
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1028
Test MSE (smoothed with alpha=0.01): 0.2278
New best smoothed test MSE: 0.2278. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1025
Test MSE group_1: 0.1034
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1057
train MSE group_1: 0.1517
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0210 [Test seq (cond on sampled tp)] | Loss 395.513489 | Likelihood -423.403809 | KL fp 3.5112 | FP STD 0.4586|
KL coef: 0.8660203251420383
Train loss (one batch): 511.727294921875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0854
Test MSE (smoothed with alpha=0.01): 0.2264
New best smoothed test MSE: 0.2264. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0885
Test MSE group_1: 0.0806
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0980
train MSE group_1: 0.1093
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0220 [Test seq (cond on sampled tp)] | Loss 267.159210 | Likelihood -271.510498 | KL fp 3.8366 | FP STD 0.4383|
KL coef: 0.8788311836429517
Train loss (one batch): 351.8582763671875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0550
Test MSE (smoothed with alpha=0.01): 0.2246
New best smoothed test MSE: 0.2246. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0504
Test MSE group_1: 0.0622
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0620
train MSE group_1: 0.0788
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0230 [Test seq (cond on sampled tp)] | Loss 238.696747 | Likelihood -248.150223 | KL fp 4.1354 | FP STD 0.4157|
KL coef: 0.8904170944366518
Train loss (one batch): 308.0392761230469
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0504
Test MSE (smoothed with alpha=0.01): 0.2229
New best smoothed test MSE: 0.2229. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0431
Test MSE group_1: 0.0616
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0520
train MSE group_1: 0.0718
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0240 [Test seq (cond on sampled tp)] | Loss 212.092712 | Likelihood -215.775833 | KL fp 4.2156 | FP STD 0.3921|
KL coef: 0.9008951844811254
Train loss (one batch): 280.0755615234375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0439
Test MSE (smoothed with alpha=0.01): 0.2211
New best smoothed test MSE: 0.2211. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0362
Test MSE group_1: 0.0557
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0448
train MSE group_1: 0.0673
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0250 [Test seq (cond on sampled tp)] | Loss 974.210938 | Likelihood -1025.122925 | KL fp 2.3532 | FP STD 0.6150|
KL coef: 0.9103713812976754
Train loss (one batch): 1348.456298828125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.2058
Test MSE (smoothed with alpha=0.01): 0.2210
New best smoothed test MSE: 0.2210. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.2473
Test MSE group_1: 0.1418
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.3322
train MSE group_1: 0.2276
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0260 [Test seq (cond on sampled tp)] | Loss 652.808411 | Likelihood -715.407104 | KL fp 3.4433 | FP STD 0.6527|
KL coef: 0.9189414838378187
Train loss (one batch): 1106.35595703125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1438
Test MSE (smoothed with alpha=0.01): 0.2202
New best smoothed test MSE: 0.2202. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1335
Test MSE group_1: 0.1597
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1515
train MSE group_1: 0.2970
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0270 [Test seq (cond on sampled tp)] | Loss 852.925293 | Likelihood -902.103882 | KL fp 3.8689 | FP STD 0.5752|
KL coef: 0.9266921309561118
Train loss (one batch): 873.9840087890625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1812
Test MSE (smoothed with alpha=0.01): 0.2198
New best smoothed test MSE: 0.2198. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.2104
Test MSE group_1: 0.1362
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1984
train MSE group_1: 0.1602
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0280 [Test seq (cond on sampled tp)] | Loss 654.006470 | Likelihood -677.870667 | KL fp 3.6055 | FP STD 0.5990|
KL coef: 0.9337016772796147
Train loss (one batch): 792.6646118164062
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1363
Test MSE (smoothed with alpha=0.01): 0.2190
New best smoothed test MSE: 0.2190. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1472
Test MSE group_1: 0.1196
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1470
train MSE group_1: 0.1738
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0290 [Test seq (cond on sampled tp)] | Loss 664.455750 | Likelihood -686.972168 | KL fp 3.8920 | FP STD 0.5501|
KL coef: 0.9400409853285345
Train loss (one batch): 767.4581298828125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1381
Test MSE (smoothed with alpha=0.01): 0.2181
New best smoothed test MSE: 0.2181. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1512
Test MSE group_1: 0.1181
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1442
train MSE group_1: 0.1660
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0300 [Test seq (cond on sampled tp)] | Loss 653.305359 | Likelihood -673.120422 | KL fp 3.1719 | FP STD 0.6104|
KL coef: 0.9457741418959368
Train loss (one batch): 758.8449096679688
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1354
Test MSE (smoothed with alpha=0.01): 0.2173
New best smoothed test MSE: 0.2173. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1508
Test MSE group_1: 0.1116
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1506
train MSE group_1: 0.1572
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0310 [Test seq (cond on sampled tp)] | Loss 641.154846 | Likelihood -662.100647 | KL fp 3.2494 | FP STD 0.6001|
KL coef: 0.9509591059287142
Train loss (one batch): 736.1507568359375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1332
Test MSE (smoothed with alpha=0.01): 0.2165
New best smoothed test MSE: 0.2165. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1454
Test MSE group_1: 0.1143
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1407
train MSE group_1: 0.1545
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0320 [Test seq (cond on sampled tp)] | Loss 612.095215 | Likelihood -629.629150 | KL fp 3.5543 | FP STD 0.5638|
KL coef: 0.9556482944595236
Train loss (one batch): 717.3004760742188
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1267
Test MSE (smoothed with alpha=0.01): 0.2156
New best smoothed test MSE: 0.2156. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1367
Test MSE group_1: 0.1113
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1362
train MSE group_1: 0.1528
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0330 [Test seq (cond on sampled tp)] | Loss 569.734924 | Likelihood -607.086304 | KL fp 3.6315 | FP STD 0.5781|
KL coef: 0.9598891125131245
Train loss (one batch): 676.9773559570312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1222
Test MSE (smoothed with alpha=0.01): 0.2146
New best smoothed test MSE: 0.2146. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1310
Test MSE group_1: 0.1086
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1302
train MSE group_1: 0.1419
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0340 [Test seq (cond on sampled tp)] | Loss 551.772400 | Likelihood -576.295532 | KL fp 3.1914 | FP STD 0.6710|
KL coef: 0.9637244323441748
Train loss (one batch): 630.0613403320312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1160
Test MSE (smoothed with alpha=0.01): 0.2137
New best smoothed test MSE: 0.2137. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.1215
Test MSE group_1: 0.1076
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1245
train MSE group_1: 0.1323
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0350 [Test seq (cond on sampled tp)] | Loss 482.233276 | Likelihood -508.480621 | KL fp 3.3215 | FP STD 0.6502|
KL coef: 0.9671930268513026
Train loss (one batch): 560.4264526367188
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1024
Test MSE (smoothed with alpha=0.01): 0.2125
New best smoothed test MSE: 0.2125. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0999
Test MSE group_1: 0.1064
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1043
train MSE group_1: 0.1225
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0360 [Test seq (cond on sampled tp)] | Loss 444.572601 | Likelihood -464.383301 | KL fp 3.7339 | FP STD 0.6079|
KL coef: 0.9703299615490228
Train loss (one batch): 521.1822509765625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0936
Test MSE (smoothed with alpha=0.01): 0.2114
New best smoothed test MSE: 0.2114. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0858
Test MSE group_1: 0.1056
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0955
train MSE group_1: 0.1137
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0370 [Test seq (cond on sampled tp)] | Loss 415.901886 | Likelihood -434.651855 | KL fp 3.6412 | FP STD 0.6095|
KL coef: 0.9731669490601144
Train loss (one batch): 484.83935546875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0877
Test MSE (smoothed with alpha=0.01): 0.2101
New best smoothed test MSE: 0.2101. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0756
Test MSE group_1: 0.1062
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0894
train MSE group_1: 0.1074
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0380 [Test seq (cond on sampled tp)] | Loss 378.331451 | Likelihood -404.253021 | KL fp 3.5912 | FP STD 0.6491|
KL coef: 0.9757326697121692
Train loss (one batch): 471.6703796386719
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0816
Test MSE (smoothed with alpha=0.01): 0.2088
New best smoothed test MSE: 0.2088. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0675
Test MSE group_1: 0.1033
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0838
train MSE group_1: 0.1078
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0390 [Test seq (cond on sampled tp)] | Loss 332.660431 | Likelihood -377.895386 | KL fp 3.5900 | FP STD 0.6420|
KL coef: 0.9780530614793677
Train loss (one batch): 446.3801574707031
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0763
Test MSE (smoothed with alpha=0.01): 0.2075
New best smoothed test MSE: 0.2075. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0626
Test MSE group_1: 0.0974
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0750
train MSE group_1: 0.1033
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0400 [Test seq (cond on sampled tp)] | Loss 305.905121 | Likelihood -317.169586 | KL fp 3.5986 | FP STD 0.6186|
KL coef: 0.9801515822006198
Train loss (one batch): 368.71539306640625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0642
Test MSE (smoothed with alpha=0.01): 0.2061
New best smoothed test MSE: 0.2061. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0533
Test MSE group_1: 0.0809
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0646
train MSE group_1: 0.0880
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0410 [Test seq (cond on sampled tp)] | Loss 246.252075 | Likelihood -264.456482 | KL fp 3.6221 | FP STD 0.6129|
KL coef: 0.9820494467249549
Train loss (one batch): 330.947998046875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0536
Test MSE (smoothed with alpha=0.01): 0.2046
New best smoothed test MSE: 0.2046. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0458
Test MSE group_1: 0.0657
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0580
train MSE group_1: 0.0778
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0420 [Test seq (cond on sampled tp)] | Loss 220.122452 | Likelihood -227.842361 | KL fp 3.9675 | FP STD 0.5917|
KL coef: 0.9837658413815585
Train loss (one batch): 308.406982421875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0463
Test MSE (smoothed with alpha=0.01): 0.2030
New best smoothed test MSE: 0.2030. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0392
Test MSE group_1: 0.0572
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0514
train MSE group_1: 0.0724
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0430 [Test seq (cond on sampled tp)] | Loss 193.632507 | Likelihood -213.411041 | KL fp 4.0172 | FP STD 0.5945|
KL coef: 0.9853181179426319
Train loss (one batch): 279.7533264160156
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0434
Test MSE (smoothed with alpha=0.01): 0.2014
New best smoothed test MSE: 0.2014. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0352
Test MSE group_1: 0.0560
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0446
train MSE group_1: 0.0689
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0440 [Test seq (cond on sampled tp)] | Loss 207.177322 | Likelihood -214.810577 | KL fp 3.7487 | FP STD 0.6045|
KL coef: 0.9867219690399229
Train loss (one batch): 259.4033203125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0437
Test MSE (smoothed with alpha=0.01): 0.1998
New best smoothed test MSE: 0.1998. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0343
Test MSE group_1: 0.0581
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0426
train MSE group_1: 0.0625
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0450 [Test seq (cond on sampled tp)] | Loss 190.450653 | Likelihood -202.153580 | KL fp 3.7368 | FP STD 0.6092|
KL coef: 0.9879915868082944
Train loss (one batch): 256.38397216796875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0412
Test MSE (smoothed with alpha=0.01): 0.1982
New best smoothed test MSE: 0.1982. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0349
Test MSE group_1: 0.0508
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0406
train MSE group_1: 0.0618
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0460 [Test seq (cond on sampled tp)] | Loss 190.287689 | Likelihood -198.989349 | KL fp 3.7341 | FP STD 0.5981|
KL coef: 0.9891398063601221
Train loss (one batch): 244.2495574951172
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0405
Test MSE (smoothed with alpha=0.01): 0.1966
New best smoothed test MSE: 0.1966. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0329
Test MSE group_1: 0.0522
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0379
train MSE group_1: 0.0607
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0470 [Test seq (cond on sampled tp)] | Loss 205.103775 | Likelihood -215.962723 | KL fp 3.5240 | FP STD 0.6466|
KL coef: 0.9901782355409698
Train loss (one batch): 245.45623779296875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0439
Test MSE (smoothed with alpha=0.01): 0.1951
New best smoothed test MSE: 0.1951. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0348
Test MSE group_1: 0.0580
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0347
train MSE group_1: 0.0641
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0480 [Test seq (cond on sampled tp)] | Loss 272.275482 | Likelihood -331.398071 | KL fp 3.1833 | FP STD 0.8264|
KL coef: 0.9911173722782946
Train loss (one batch): 405.0190124511719
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0670
Test MSE (smoothed with alpha=0.01): 0.1938
New best smoothed test MSE: 0.1938. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0632
Test MSE group_1: 0.0729
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0725
train MSE group_1: 0.0953
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0490 [Test seq (cond on sampled tp)] | Loss 276.974243 | Likelihood -331.465393 | KL fp 3.3847 | FP STD 0.7689|
KL coef: 0.9919667107095133
Train loss (one batch): 356.2320556640625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0670
Test MSE (smoothed with alpha=0.01): 0.1926
New best smoothed test MSE: 0.1926. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0581
Test MSE group_1: 0.0807
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0637
train MSE group_1: 0.0882
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0500 [Test seq (cond on sampled tp)] | Loss 242.955460 | Likelihood -263.930328 | KL fp 3.8324 | FP STD 0.6966|
KL coef: 0.9927348371623237
Train loss (one batch): 304.418701171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0535
Test MSE (smoothed with alpha=0.01): 0.1912
New best smoothed test MSE: 0.1912. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0426
Test MSE group_1: 0.0703
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0456
train MSE group_1: 0.0790
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0510 [Test seq (cond on sampled tp)] | Loss 210.951263 | Likelihood -227.776688 | KL fp 3.7709 | FP STD 0.6826|
KL coef: 0.9934295169575854
Train loss (one batch): 279.64599609375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0463
Test MSE (smoothed with alpha=0.01): 0.1897
New best smoothed test MSE: 0.1897. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0366
Test MSE group_1: 0.0612
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0471
train MSE group_1: 0.0701
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0520 [Test seq (cond on sampled tp)] | Loss 196.263550 | Likelihood -219.148315 | KL fp 3.6125 | FP STD 0.6787|
KL coef: 0.9940577729122909
Train loss (one batch): 262.30792236328125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0446
Test MSE (smoothed with alpha=0.01): 0.1883
New best smoothed test MSE: 0.1883. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0354
Test MSE group_1: 0.0587
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0396
train MSE group_1: 0.0657
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0530 [Test seq (cond on sampled tp)] | Loss 204.709366 | Likelihood -218.649780 | KL fp 3.6502 | FP STD 0.6720|
KL coef: 0.9946259563362442
Train loss (one batch): 254.1621551513672
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0445
Test MSE (smoothed with alpha=0.01): 0.1868
New best smoothed test MSE: 0.1868. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0373
Test MSE group_1: 0.0554
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0385
train MSE group_1: 0.0632
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0540 [Test seq (cond on sampled tp)] | Loss 193.867722 | Likelihood -207.409271 | KL fp 3.6732 | FP STD 0.6596|
KL coef: 0.9951398112401846
Train loss (one batch): 241.02980041503906
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0422
Test MSE (smoothed with alpha=0.01): 0.1854
New best smoothed test MSE: 0.1854. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0346
Test MSE group_1: 0.0539
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0368
train MSE group_1: 0.0594
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24710
Epoch 0550 [Test seq (cond on sampled tp)] | Loss 188.586884 | Likelihood -205.257233 | KL fp 3.6833 | FP STD 0.6477|
KL coef: 0.9956045324044637
Train loss (one batch): 235.30038452148438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0418
Test MSE (smoothed with alpha=0.01): 0.1839
New best smoothed test MSE: 0.1839. Saving best model to experiments/experiment_24710_best.ckpt
Test MSE group_0: 0.0331
Test MSE group_1: 0.0552
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0346
train MSE group_1: 0.0609
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['163', '164', '165', '166', '167', '168', '169', '170', '172', '173', '175', '176', '177', '178', '179', '180', '181', '183', '184', '185', '186', '187', '188', '189', '190', '193', '194', '195', '196', '197', '198', '199', '200']
164
TensorBoard logs will be saved to: experiments/runs/24710
Traceback (most recent call last):
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py", line 288, in <module>
    train_res = model.compute_all_losses(batch_dict, n_traj_samples = 3, kl_coef = kl_coef)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/base_models.py", line 325, in compute_all_losses
    rec_likelihood = self.get_gaussian_likelihood(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/base_models.py", line 227, in get_gaussian_likelihood
    log_density_data = masked_gaussian_log_density(pred_y, truth_repeated, 
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/likelihood_eval.py", line 193, in masked_gaussian_log_density
    res = compute_masked_likelihood(mu, data, mask, func)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/likelihood_eval.py", line 153, in compute_masked_likelihood
    log_prob = likelihood_func(mu_masked, data_masked, indices = (i,k,j))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/likelihood_eval.py", line 192, in <lambda>
    func = lambda mu, data, indices: gaussian_log_likelihood(mu, data, obsrv_std = obsrv_std, indices = indices)
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/likelihood_eval.py", line 30, in gaussian_log_likelihood
    log_prob = gaussian.log_prob(data_2d) 
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/distributions/independent.py", line 111, in log_prob
    return _sum_rightmost(log_prob, self.reinterpreted_batch_ndims)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/distributions/utils.py", line 68, in _sum_rightmost
    def _sum_rightmost(value, dim):
    
KeyboardInterrupt
