/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 3000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 24962
Experiment 24962
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 1544.007080 | Likelihood -1628.795776 | KL fp 3.7264 | FP STD 0.6577|
KL coef: 0.0
Train loss (one batch): 2363.20068359375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.3265
Test MSE (smoothed with alpha=0.01): 0.3265
New best smoothed test MSE: 0.3265. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.3205
Test MSE group_1: 0.3310
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.5031
train MSE group_1: 0.4447
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 663.426025 | Likelihood -690.856750 | KL fp 5.6906 | FP STD 0.4943|
KL coef: 0.09561792499119559
Train loss (one batch): 749.3038330078125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1389
Test MSE (smoothed with alpha=0.01): 0.3246
New best smoothed test MSE: 0.3246. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.1090
Test MSE group_1: 0.1736
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1113
train MSE group_1: 0.2155
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 553.821533 | Likelihood -570.466064 | KL fp 5.4905 | FP STD 0.3957|
KL coef: 0.18209306240276923
Train loss (one batch): 650.176513671875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1148
Test MSE (smoothed with alpha=0.01): 0.3225
New best smoothed test MSE: 0.3225. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.1048
Test MSE group_1: 0.1259
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1138
train MSE group_1: 0.1562
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 527.243225 | Likelihood -541.356384 | KL fp 6.9406 | FP STD 0.2673|
KL coef: 0.2602996266117198
Train loss (one batch): 630.3068237304688
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1090
Test MSE (smoothed with alpha=0.01): 0.3204
New best smoothed test MSE: 0.3204. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0924
Test MSE group_1: 0.1278
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1017
train MSE group_1: 0.1631
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 530.233154 | Likelihood -538.657349 | KL fp 6.6983 | FP STD 0.2427|
KL coef: 0.3310282414303197
Train loss (one batch): 617.290283203125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1085
Test MSE (smoothed with alpha=0.01): 0.3183
New best smoothed test MSE: 0.3183. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0964
Test MSE group_1: 0.1218
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1036
train MSE group_1: 0.1557
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 516.308044 | Likelihood -531.397034 | KL fp 6.2512 | FP STD 0.2109|
KL coef: 0.39499393286246365
Train loss (one batch): 595.958984375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1070
Test MSE (smoothed with alpha=0.01): 0.3162
New best smoothed test MSE: 0.3162. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0953
Test MSE group_1: 0.1200
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0984
train MSE group_1: 0.1512
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 507.517517 | Likelihood -518.850830 | KL fp 6.2395 | FP STD 0.2285|
KL coef: 0.4528433576092388
Train loss (one batch): 590.0564575195312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1045
Test MSE (smoothed with alpha=0.01): 0.3140
New best smoothed test MSE: 0.3140. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0932
Test MSE group_1: 0.1171
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0966
train MSE group_1: 0.1531
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0080 [Test seq (cond on sampled tp)] | Loss 493.014587 | Likelihood -511.831543 | KL fp 5.7829 | FP STD 0.2885|
KL coef: 0.505161340399793
Train loss (one batch): 585.5777587890625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1031
Test MSE (smoothed with alpha=0.01): 0.3119
New best smoothed test MSE: 0.3119. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0918
Test MSE group_1: 0.1158
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0955
train MSE group_1: 0.1538
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0090 [Test seq (cond on sampled tp)] | Loss 478.845551 | Likelihood -481.515198 | KL fp 6.4889 | FP STD 0.1670|
KL coef: 0.5524767862361895
Train loss (one batch): 559.352783203125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0970
Test MSE (smoothed with alpha=0.01): 0.3098
New best smoothed test MSE: 0.3098. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0840
Test MSE group_1: 0.1118
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0898
train MSE group_1: 0.1453
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0100 [Test seq (cond on sampled tp)] | Loss 443.316040 | Likelihood -449.668488 | KL fp 5.9544 | FP STD 0.2180|
KL coef: 0.5952680273216762
Train loss (one batch): 514.5625610351562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0907
Test MSE (smoothed with alpha=0.01): 0.3076
New best smoothed test MSE: 0.3076. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0800
Test MSE group_1: 0.1027
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0835
train MSE group_1: 0.1326
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0110 [Test seq (cond on sampled tp)] | Loss 361.712036 | Likelihood -371.253876 | KL fp 5.9444 | FP STD 0.2166|
KL coef: 0.6339676587267709
Train loss (one batch): 432.40216064453125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0750
Test MSE (smoothed with alpha=0.01): 0.3053
New best smoothed test MSE: 0.3053. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0645
Test MSE group_1: 0.0865
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0696
train MSE group_1: 0.1131
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0120 [Test seq (cond on sampled tp)] | Loss 268.684448 | Likelihood -275.957733 | KL fp 5.8819 | FP STD 0.2475|
KL coef: 0.6689669116789861
Train loss (one batch): 302.72845458984375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0559
Test MSE (smoothed with alpha=0.01): 0.3028
New best smoothed test MSE: 0.3028. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0484
Test MSE group_1: 0.0638
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0453
train MSE group_1: 0.0837
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0130 [Test seq (cond on sampled tp)] | Loss 283.013428 | Likelihood -291.221771 | KL fp 5.3468 | FP STD 0.2790|
KL coef: 0.7006196086876687
Train loss (one batch): 256.52276611328125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0590
Test MSE (smoothed with alpha=0.01): 0.3003
New best smoothed test MSE: 0.3003. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0325
Test MSE group_1: 0.0897
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0443
train MSE group_1: 0.0635
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0140 [Test seq (cond on sampled tp)] | Loss 206.180405 | Likelihood -208.290405 | KL fp 6.0138 | FP STD 0.2319|
KL coef: 0.729245740488006
Train loss (one batch): 274.68231201171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0424
Test MSE (smoothed with alpha=0.01): 0.2978
New best smoothed test MSE: 0.2978. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0319
Test MSE group_1: 0.0538
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0389
train MSE group_1: 0.0793
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0150 [Test seq (cond on sampled tp)] | Loss 231.798706 | Likelihood -235.471970 | KL fp 6.2672 | FP STD 0.2157|
KL coef: 0.7551347009650705
Train loss (one batch): 226.26060485839844
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0478
Test MSE (smoothed with alpha=0.01): 0.2953
New best smoothed test MSE: 0.2953. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0366
Test MSE group_1: 0.0601
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0309
train MSE group_1: 0.0661
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0160 [Test seq (cond on sampled tp)] | Loss 192.929352 | Likelihood -192.356888 | KL fp 5.9100 | FP STD 0.1817|
KL coef: 0.7785482127611391
Train loss (one batch): 205.9447784423828
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0392
Test MSE (smoothed with alpha=0.01): 0.2927
New best smoothed test MSE: 0.2927. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0271
Test MSE group_1: 0.0528
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0296
train MSE group_1: 0.0581
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0170 [Test seq (cond on sampled tp)] | Loss 182.192093 | Likelihood -181.709717 | KL fp 6.3375 | FP STD 0.1618|
KL coef: 0.7997229731425107
Train loss (one batch): 179.81985473632812
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0371
Test MSE (smoothed with alpha=0.01): 0.2901
New best smoothed test MSE: 0.2901. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0254
Test MSE group_1: 0.0500
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0240
train MSE group_1: 0.0535
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0180 [Test seq (cond on sampled tp)] | Loss 190.185791 | Likelihood -188.808563 | KL fp 6.2690 | FP STD 0.1659|
KL coef: 0.8188730468740297
Train loss (one batch): 181.0787353515625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0385
Test MSE (smoothed with alpha=0.01): 0.2876
New best smoothed test MSE: 0.2876. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0271
Test MSE group_1: 0.0512
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0238
train MSE group_1: 0.0543
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0190 [Test seq (cond on sampled tp)] | Loss 179.100861 | Likelihood -178.327637 | KL fp 6.0381 | FP STD 0.1658|
KL coef: 0.8361920302919126
Train loss (one batch): 182.3385009765625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0364
Test MSE (smoothed with alpha=0.01): 0.2851
New best smoothed test MSE: 0.2851. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0248
Test MSE group_1: 0.0493
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0250
train MSE group_1: 0.0530
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0200 [Test seq (cond on sampled tp)] | Loss 231.437561 | Likelihood -237.381012 | KL fp 5.1862 | FP STD 0.3698|
KL coef: 0.8518550084524206
Train loss (one batch): 244.40126037597656
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0482
Test MSE (smoothed with alpha=0.01): 0.2827
New best smoothed test MSE: 0.2827. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0361
Test MSE group_1: 0.0618
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0346
train MSE group_1: 0.0699
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0210 [Test seq (cond on sampled tp)] | Loss 270.484558 | Likelihood -284.667572 | KL fp 5.9113 | FP STD 0.3218|
KL coef: 0.8660203251420383
Train loss (one batch): 307.73992919921875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0577
Test MSE (smoothed with alpha=0.01): 0.2805
New best smoothed test MSE: 0.2805. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0443
Test MSE group_1: 0.0726
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0473
train MSE group_1: 0.0850
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0220 [Test seq (cond on sampled tp)] | Loss 187.975342 | Likelihood -191.879288 | KL fp 5.5125 | FP STD 0.2434|
KL coef: 0.8788311836429517
Train loss (one batch): 187.29527282714844
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0391
Test MSE (smoothed with alpha=0.01): 0.2781
New best smoothed test MSE: 0.2781. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0270
Test MSE group_1: 0.0526
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0250
train MSE group_1: 0.0559
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0230 [Test seq (cond on sampled tp)] | Loss 174.459732 | Likelihood -174.646164 | KL fp 6.0886 | FP STD 0.2061|
KL coef: 0.8904170944366518
Train loss (one batch): 180.70249938964844
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0357
Test MSE (smoothed with alpha=0.01): 0.2757
New best smoothed test MSE: 0.2757. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0232
Test MSE group_1: 0.0496
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0239
train MSE group_1: 0.0533
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0240 [Test seq (cond on sampled tp)] | Loss 174.202530 | Likelihood -172.394684 | KL fp 5.9294 | FP STD 0.1945|
KL coef: 0.9008951844811254
Train loss (one batch): 176.4168243408203
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0352
Test MSE (smoothed with alpha=0.01): 0.2732
New best smoothed test MSE: 0.2732. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0237
Test MSE group_1: 0.0480
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0230
train MSE group_1: 0.0534
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0250 [Test seq (cond on sampled tp)] | Loss 171.062561 | Likelihood -169.329468 | KL fp 6.0603 | FP STD 0.1673|
KL coef: 0.9103713812976754
Train loss (one batch): 172.40243530273438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0346
Test MSE (smoothed with alpha=0.01): 0.2709
New best smoothed test MSE: 0.2709. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0233
Test MSE group_1: 0.0472
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0219
train MSE group_1: 0.0521
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0260 [Test seq (cond on sampled tp)] | Loss 182.960205 | Likelihood -188.979614 | KL fp 5.3731 | FP STD 0.2686|
KL coef: 0.9189414838378187
Train loss (one batch): 192.62374877929688
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0385
Test MSE (smoothed with alpha=0.01): 0.2685
New best smoothed test MSE: 0.2685. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0279
Test MSE group_1: 0.0504
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0271
train MSE group_1: 0.0555
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0270 [Test seq (cond on sampled tp)] | Loss 188.560547 | Likelihood -191.878082 | KL fp 5.8185 | FP STD 0.2583|
KL coef: 0.9266921309561118
Train loss (one batch): 204.0503692626953
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0391
Test MSE (smoothed with alpha=0.01): 0.2662
New best smoothed test MSE: 0.2662. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0281
Test MSE group_1: 0.0513
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0314
train MSE group_1: 0.0579
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0280 [Test seq (cond on sampled tp)] | Loss 177.398468 | Likelihood -178.988068 | KL fp 5.7710 | FP STD 0.2254|
KL coef: 0.9337016772796147
Train loss (one batch): 186.77781677246094
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0365
Test MSE (smoothed with alpha=0.01): 0.2639
New best smoothed test MSE: 0.2639. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0248
Test MSE group_1: 0.0496
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0254
train MSE group_1: 0.0548
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0290 [Test seq (cond on sampled tp)] | Loss 175.055145 | Likelihood -173.441833 | KL fp 5.8122 | FP STD 0.1976|
KL coef: 0.9400409853285345
Train loss (one batch): 172.3316192626953
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0354
Test MSE (smoothed with alpha=0.01): 0.2617
New best smoothed test MSE: 0.2617. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0242
Test MSE group_1: 0.0479
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0221
train MSE group_1: 0.0523
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 24962
Epoch 0300 [Test seq (cond on sampled tp)] | Loss 172.438416 | Likelihood -170.794998 | KL fp 5.7518 | FP STD 0.1846|
KL coef: 0.9457741418959368
Train loss (one batch): 169.1829376220703
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0349
Test MSE (smoothed with alpha=0.01): 0.2594
New best smoothed test MSE: 0.2594. Saving best model to experiments/experiment_24962_best.ckpt
Test MSE group_0: 0.0237
Test MSE group_1: 0.0474
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0210
train MSE group_1: 0.0518
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['210', '211', '212', '213', '214', '216', '217', '218', '219', '220', '221', '222', '223', '224', '225', '226', '227', '228', '230', '231', '233', '234', '235', '236', '237', '238', '241', '242', '243', '244', '246', '247', '248', '250', '251', '253', '254', '255', '256', '258', '259', '261', '262', '263', '265', '267', '269', '270', '271', '273', '274', '278', '279', '280', '281', '282', '283', '284', '285', '287', '288', '290', '291', '292', '293', '294', '295', '296', '298', '299', '302', '303', '304', '305', '306', '308', '310', '311', '312', '313', '316', '317', '319', '320', '322', '323', '324', '326', '327', '329', '330', '331', '333', '334', '335', '336', '337', '338', '339', '342', '343', '344', '346', '349', '352', '353', '354', '355', '356', '357', '359', '360', '362', '363', '364', '366', '368', '369', '371', '372', '373', '374', '375', '377', '379', '381', '382', '383', '384', '385', '386', '387', '388', '389', '390', '392', '393', '394', '395', '396', '397', '399', '400', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '412', '413', '414', '416', '417', '418', '419', '420', '421', '422', '424', '425', '426', '427', '428', '429', '431', '432', '434', '435', '436', '438', '439', '440', '441', '442', '443', '444', '445', '446', '447', '448', '449', '450', '452', '453', '454', '455', '458', '459', '462', '463', '464', '465', '467', '468', '469', '470', '471', '472', '473', '474', '477', '478', '479', '481', '482', '483', '486', '490', '491', '492', '493', '494', '495', '497', '498', '499', '500', '501', '504', '505', '506', '507', '508', '509', '510', '511', '512', '513', '514', '515', '516', '517', '518', '519', '520', '521', '522', '525', '526', '528', '529', '531', '532', '533', '534', '535', '536', '537', '539', '540', '541', '542', '543', '544', '545', '548', '549', '550', '551', '552', '554', '555', '556', '559', '560', '561', '562', '563', '566', '568', '569', '570', '571', '572', '573', '574', '575', '576', '577', '578', '579', '580', '581', '582', '583', '584', '585', '586', '587', '588', '592', '593', '594', '595', '596', '597', '598', '599', '600', '601', '602', '603', '605', '606', '607', '608', '609', '610', '611', '613', '614', '616', '617', '620', '621', '622', '623', '624', '625', '626', '627', '628', '629', '630', '631', '632', '633', '634', '635', '636', '638', '639', '640', '641', '642', '644', '646', '647', '649', '651', '652', '653', '654', '655', '658', '660', '661', '663', '664', '665', '666', '668', '670', '672', '673', '674', '675', '676', '677', '678', '680', '681', '682', '684', '685', '687', '689', '692', '693', '694', '695', '696', '697', '699', '701', '702', '703', '704', '706', '707', '708', '709', '712', '714', '715', '716', '717', '718', '720', '721', '722', '724', '725', '726', '729', '731', '732', '733', '735', '736', '738', '740', '742', '743', '745', '748', '749', '750', '751', '752', '753', '754', '755', '757', '758', '759', '760', '761', '762', '763', '764', '766', '767', '768', '769', '770', '771', '773', '774', '775', '778', '779', '780', '781', '782', '784', '785', '786', '787', '790', '791', '792', '793', '794', '795', '797', '798', '800', '801', '803', '804', '805', '807', '808', '810', '811', '812', '813', '814', '815', '816', '818', '819', '820', '821', '823', '824', '825', '826', '827', '828', '829', '831', '832', '833', '834', '835', '836', '837', '838', '840', '841', '842', '843', '844', '845', '847', '849', '850', '852', '853', '855', '856', '857', '858', '859', '860', '861', '862', '863', '864', '865', '866', '867', '868', '869', '870', '872', '873', '874', '876', '877', '878', '879', '881', '882', '883', '884', '885', '886', '887', '890', '892', '893', '894', '895', '897', '899', '900', '901', '902', '903', '904', '906', '907', '908', '910', '911', '913', '915', '917', '918', '919', '920', '921', '923', '927', '928', '930', '932', '933', '934', '935', '937', '938', '939', '940', '941', '942', '943', '944', '945', '946', '947', '948', '949', '950', '951', '953', '954', '955', '958', '959', '960', '961', '962', '963', '964', '965', '966', '967', '968', '969', '970', '971', '972', '973', '974', '976', '979', '980', '981', '983', '984', '985', '987', '988', '989', '990', '991', '992', '993', '994', '995', '996', '997', '998', '999', '1000']
767
TensorBoard logs will be saved to: experiments/runs/24962
Traceback (most recent call last):
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py", line 296, in <module>
    test_res = compute_loss_all_batches(model, 
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/utils.py", line 608, in compute_loss_all_batches
    results  = model.compute_all_losses(batch_dict,n_traj_samples = n_traj_samples, kl_coef = kl_coef, max_out = data_obj['max_out'])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/base_models.py", line 261, in compute_all_losses
    pred_y, info = self.get_reconstruction(batch_dict["tp_to_predict"], 
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/latent_ode.py", line 98, in get_reconstruction
    sol_y = self.diffeq_solver(first_point_enc_aug, time_steps_to_predict)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/diffeq_solver.py", line 40, in forward
    pred_y = odeint(self.ode_func, first_point, time_steps_to_predict, 
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/odeint.py", line 80, in odeint
    solution = solver.integrate(t)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/solvers.py", line 34, in integrate
    solution[i] = self._advance(t[i])
                  ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/rk_common.py", line 246, in _advance
    self.rk_state = self._adaptive_step(self.rk_state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/rk_common.py", line 311, in _adaptive_step
    y1, f1, y1_error, k = _runge_kutta_step(self.func, y0, f0, t0, dt, t1, tableau=self.tableau)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/rk_common.py", line 78, in _runge_kutta_step
    f = func(ti, yi, perturb=perturb)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/misc.py", line 187, in forward
    t = t.to(y.abs().dtype)
        ^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
