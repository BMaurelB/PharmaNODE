/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:199: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df = df.applymap(lambda x: str(x).replace(",", ".") if isinstance(x, str) else x)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:199: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df = df.applymap(lambda x: str(x).replace(",", ".") if isinstance(x, str) else x)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/read_tacro.py:109: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df = df.applymap(lambda x: str(x).replace(",", ".") if isinstance(x, str) else x)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/plotting.py:295: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show(block=False)
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 50000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --viz --noise-weight 0.01 --max-t 5. --seed 52 --experiment 29689
Experiment 29689
Epoch 0001 [Test seq (cond on sampled tp)] | Loss 2726.827148 | Likelihood -2879.614258 | KL fp 2.2775 | FP STD 0.0875|
KL coef: 0.0
Train loss (one batch): 395.0416259765625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.5767
Test MSE (smoothed with alpha=0.01): 0.5767
New best smoothed test MSE: 0.5767. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.5767
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0805
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0002 [Test seq (cond on sampled tp)] | Loss 2233.526855 | Likelihood -2525.167236 | KL fp 2.7512 | FP STD 0.0812|
KL coef: 0.0
Train loss (one batch): 2500.6064453125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.5058
Test MSE (smoothed with alpha=0.01): 0.5760
New best smoothed test MSE: 0.5760. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.5058
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.5026
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0003 [Test seq (cond on sampled tp)] | Loss 659.128357 | Likelihood -681.014709 | KL fp 2.9519 | FP STD 0.0566|
KL coef: 0.0
Train loss (one batch): 2435.978271484375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1369
Test MSE (smoothed with alpha=0.01): 0.5716
New best smoothed test MSE: 0.5716. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.1369
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.4905
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0004 [Test seq (cond on sampled tp)] | Loss 586.380249 | Likelihood -592.805176 | KL fp 2.8647 | FP STD 0.0615|
KL coef: 0.0
Train loss (one batch): 493.9369812011719
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1193
Test MSE (smoothed with alpha=0.01): 0.5670
New best smoothed test MSE: 0.5670. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.1193
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.1002
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0005 [Test seq (cond on sampled tp)] | Loss 482.187805 | Likelihood -493.398041 | KL fp 2.4404 | FP STD 0.0740|
KL coef: 0.0
Train loss (one batch): 422.18572998046875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0994
Test MSE (smoothed with alpha=0.01): 0.5624
New best smoothed test MSE: 0.5624. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0994
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0862
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0006 [Test seq (cond on sampled tp)] | Loss 448.730316 | Likelihood -453.422943 | KL fp 2.2071 | FP STD 0.0826|
KL coef: 0.0
Train loss (one batch): 366.6094665527344
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0914
Test MSE (smoothed with alpha=0.01): 0.5577
New best smoothed test MSE: 0.5577. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0914
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0754
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0007 [Test seq (cond on sampled tp)] | Loss 382.249634 | Likelihood -386.321198 | KL fp 2.1731 | FP STD 0.0844|
KL coef: 0.0
Train loss (one batch): 347.10009765625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0780
Test MSE (smoothed with alpha=0.01): 0.5529
New best smoothed test MSE: 0.5529. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0780
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0706
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0008 [Test seq (cond on sampled tp)] | Loss 342.369049 | Likelihood -345.023315 | KL fp 2.3730 | FP STD 0.0826|
KL coef: 0.0
Train loss (one batch): 288.8015441894531
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0697
Test MSE (smoothed with alpha=0.01): 0.5480
New best smoothed test MSE: 0.5480. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0697
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0590
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0009 [Test seq (cond on sampled tp)] | Loss 266.600708 | Likelihood -277.476959 | KL fp 2.2131 | FP STD 0.0927|
KL coef: 0.0
Train loss (one batch): 226.0692596435547
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0562
Test MSE (smoothed with alpha=0.01): 0.5431
New best smoothed test MSE: 0.5431. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0562
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0468
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 219.828232 | Likelihood -228.860779 | KL fp 2.0179 | FP STD 0.1090|
KL coef: 0.0
Train loss (one batch): 179.31378173828125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0465
Test MSE (smoothed with alpha=0.01): 0.5381
New best smoothed test MSE: 0.5381. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0465
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0368
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0011 [Test seq (cond on sampled tp)] | Loss 157.240265 | Likelihood -160.565140 | KL fp 1.9103 | FP STD 0.1321|
KL coef: 0.010000000000000009
Train loss (one batch): 135.1156005859375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0329
Test MSE (smoothed with alpha=0.01): 0.5331
New best smoothed test MSE: 0.5331. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0329
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0284
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0012 [Test seq (cond on sampled tp)] | Loss 106.474762 | Likelihood -110.894356 | KL fp 1.7519 | FP STD 0.1599|
KL coef: 0.01990000000000003
Train loss (one batch): 95.14828491210938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0229
Test MSE (smoothed with alpha=0.01): 0.5280
New best smoothed test MSE: 0.5280. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0229
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0200
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0013 [Test seq (cond on sampled tp)] | Loss 97.484322 | Likelihood -99.247009 | KL fp 1.7880 | FP STD 0.1738|
KL coef: 0.029700999999999977
Train loss (one batch): 78.47333526611328
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0206
Test MSE (smoothed with alpha=0.01): 0.5229
New best smoothed test MSE: 0.5229. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0206
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0172
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0014 [Test seq (cond on sampled tp)] | Loss 100.840927 | Likelihood -107.418060 | KL fp 1.9914 | FP STD 0.1643|
KL coef: 0.039403990000000055
Train loss (one batch): 101.9825210571289
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0222
Test MSE (smoothed with alpha=0.01): 0.5179
New best smoothed test MSE: 0.5179. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0222
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0217
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0015 [Test seq (cond on sampled tp)] | Loss 103.994263 | Likelihood -108.420448 | KL fp 2.2391 | FP STD 0.1419|
KL coef: 0.04900995010000009
Train loss (one batch): 116.74357604980469
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0224
Test MSE (smoothed with alpha=0.01): 0.5130
New best smoothed test MSE: 0.5130. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0224
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0246
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0016 [Test seq (cond on sampled tp)] | Loss 111.447701 | Likelihood -114.731056 | KL fp 2.5541 | FP STD 0.1151|
KL coef: 0.058519850599
Train loss (one batch): 98.91751861572266
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0237
Test MSE (smoothed with alpha=0.01): 0.5081
New best smoothed test MSE: 0.5081. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0237
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0212
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0017 [Test seq (cond on sampled tp)] | Loss 132.886566 | Likelihood -135.541367 | KL fp 2.7597 | FP STD 0.0932|
KL coef: 0.06793465209301008
Train loss (one batch): 82.49661254882812
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0278
Test MSE (smoothed with alpha=0.01): 0.5033
New best smoothed test MSE: 0.5033. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0278
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0176
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0018 [Test seq (cond on sampled tp)] | Loss 148.013657 | Likelihood -152.223709 | KL fp 2.6896 | FP STD 0.0821|
KL coef: 0.07725530557207994
Train loss (one batch): 81.07208251953125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0312
Test MSE (smoothed with alpha=0.01): 0.4985
New best smoothed test MSE: 0.4985. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0312
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0171
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0019 [Test seq (cond on sampled tp)] | Loss 157.114624 | Likelihood -158.061203 | KL fp 2.6490 | FP STD 0.0774|
KL coef: 0.08648275251635917
Train loss (one batch): 86.21587371826172
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0323
Test MSE (smoothed with alpha=0.01): 0.4939
New best smoothed test MSE: 0.4939. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0323
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0183
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 143.151688 | Likelihood -146.545288 | KL fp 2.4962 | FP STD 0.0776|
KL coef: 0.09561792499119559
Train loss (one batch): 86.39750671386719
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0300
Test MSE (smoothed with alpha=0.01): 0.4892
New best smoothed test MSE: 0.4892. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0300
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0182
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0021 [Test seq (cond on sampled tp)] | Loss 126.886192 | Likelihood -130.509033 | KL fp 2.4715 | FP STD 0.0783|
KL coef: 0.10466174574128362
Train loss (one batch): 83.15418243408203
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0268
Test MSE (smoothed with alpha=0.01): 0.4846
New best smoothed test MSE: 0.4846. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0268
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0175
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0022 [Test seq (cond on sampled tp)] | Loss 113.372025 | Likelihood -114.580566 | KL fp 2.5035 | FP STD 0.0788|
KL coef: 0.11361512828387077
Train loss (one batch): 76.8775405883789
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0237
Test MSE (smoothed with alpha=0.01): 0.4800
New best smoothed test MSE: 0.4800. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0237
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0163
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0023 [Test seq (cond on sampled tp)] | Loss 102.404213 | Likelihood -103.409431 | KL fp 2.5465 | FP STD 0.0795|
KL coef: 0.12247897700103216
Train loss (one batch): 74.47618103027344
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0214
Test MSE (smoothed with alpha=0.01): 0.4754
New best smoothed test MSE: 0.4754. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0214
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0159
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0024 [Test seq (cond on sampled tp)] | Loss 95.811119 | Likelihood -97.934105 | KL fp 2.4979 | FP STD 0.0786|
KL coef: 0.13125418723102178
Train loss (one batch): 78.46906280517578
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0203
Test MSE (smoothed with alpha=0.01): 0.4709
New best smoothed test MSE: 0.4709. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0203
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0166
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 29689
Epoch 0025 [Test seq (cond on sampled tp)] | Loss 100.529083 | Likelihood -103.305244 | KL fp 2.2099 | FP STD 0.1000|
KL coef: 0.13994164535871156
Train loss (one batch): 79.89429473876953
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0214
Test MSE (smoothed with alpha=0.01): 0.4664
New best smoothed test MSE: 0.4664. Saving best model to experiments/experiment_29689_best.ckpt
Test MSE group_0: nan
Test MSE group_1: 0.0214
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: nan
train MSE group_1: 0.0169
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
03BA-82M3
17DM-84M3
16BM-7J7
16BM-86M3
############## ['09MP-8J7', '18ZD-86M3', '08AA-89M3', '10MJ-7J7', '08GJ-6J7', '11RM-8J7', '05JM-88M3', '17DM-8J7', '08GJ-84M3', '13SA-7J7', '13SA-87M3', '02JD-373M3', '05JM-8J7', '09MP-90M3', '06VS-7J7', '10MJ-86M3', '08AA-8J7', '11RM-86M3', '07LB-7J7', '06VS-84M3', '18ZD-8J7', '02JD-94M3', '07LB-87M3', '03BA-8J7']
161
TensorBoard logs will be saved to: experiments/runs/29689
Traceback (most recent call last):
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py", line 288, in <module>
    train_res["loss"].backward()
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/autograd/function.py", line 292, in apply
    def apply(self, *args):

KeyboardInterrupt
