/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 5000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 31820
Experiment 31820
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 1913.756348 | Likelihood -2046.418579 | KL fp 1.9698 | FP STD 0.5468|
KL coef: 0.0
Train loss (one batch): 2395.277587890625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.4100
Test MSE (smoothed with alpha=0.01): 0.4100
New best smoothed test MSE: 0.4100. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.4754
Test MSE group_1: 0.3446
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.5728
train MSE group_1: 0.3800
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 697.506836 | Likelihood -743.446167 | KL fp 3.5256 | FP STD 0.2674|
KL coef: 0.09561792499119559
Train loss (one batch): 739.9379272460938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1494
Test MSE (smoothed with alpha=0.01): 0.4074
New best smoothed test MSE: 0.4074. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.1792
Test MSE group_1: 0.1196
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1474
train MSE group_1: 0.1530
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 589.303101 | Likelihood -613.961365 | KL fp 4.7918 | FP STD 0.2517|
KL coef: 0.18209306240276923
Train loss (one batch): 664.478515625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1235
Test MSE (smoothed with alpha=0.01): 0.4046
New best smoothed test MSE: 0.4046. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.1413
Test MSE group_1: 0.1058
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1165
train MSE group_1: 0.1556
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 403.545074 | Likelihood -424.604248 | KL fp 4.0718 | FP STD 0.2242|
KL coef: 0.2602996266117198
Train loss (one batch): 436.04949951171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0857
Test MSE (smoothed with alpha=0.01): 0.4014
New best smoothed test MSE: 0.4014. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.1067
Test MSE group_1: 0.0646
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0980
train MSE group_1: 0.0767
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 282.376068 | Likelihood -297.404694 | KL fp 4.5712 | FP STD 0.1817|
KL coef: 0.3310282414303197
Train loss (one batch): 265.5878601074219
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0602
Test MSE (smoothed with alpha=0.01): 0.3980
New best smoothed test MSE: 0.3980. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.0622
Test MSE group_1: 0.0583
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0532
train MSE group_1: 0.0624
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 236.256638 | Likelihood -241.012039 | KL fp 4.4088 | FP STD 0.1572|
KL coef: 0.39499393286246365
Train loss (one batch): 213.84149169921875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0489
Test MSE (smoothed with alpha=0.01): 0.3945
New best smoothed test MSE: 0.3945. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.0489
Test MSE group_1: 0.0490
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0340
train MSE group_1: 0.0549
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 31820
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 207.635590 | Likelihood -211.306183 | KL fp 4.6655 | FP STD 0.1350|
KL coef: 0.4528433576092388
Train loss (one batch): 198.53663635253906
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0430
Test MSE (smoothed with alpha=0.01): 0.3910
New best smoothed test MSE: 0.3910. Saving best model to experiments/experiment_31820_best.ckpt
Test MSE group_0: 0.0416
Test MSE group_1: 0.0443
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0291
train MSE group_1: 0.0533
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['162', '165', '166', '167', '168', '169', '170', '171', '172', '173', '174', '175', '176', '177', '178', '179', '180', '181', '182', '183', '185', '186', '187', '188', '189', '192', '193', '194', '195', '197']
146
TensorBoard logs will be saved to: experiments/runs/31820
Traceback (most recent call last):
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py", line 289, in <module>
    train_res["loss"].backward()
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/autograd/function.py", line 292, in apply
    def apply(self, *args):

KeyboardInterrupt
