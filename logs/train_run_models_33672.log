/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 5000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 33672
Experiment 33672
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 2345.815918 | Likelihood -2476.867188 | KL fp 3.1841 | FP STD 0.7420|
KL coef: 0.0
Train loss (one batch): 3807.53173828125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.4961
Test MSE (smoothed with alpha=0.01): 0.4961
New best smoothed test MSE: 0.4961. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.6298
Test MSE group_1: 0.3357
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.8768
train MSE group_1: 0.6622
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 1291.261230 | Likelihood -1359.775146 | KL fp 5.6976 | FP STD 0.2705|
KL coef: 0.09561792499119559
Train loss (one batch): 1311.5592041015625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.2727
Test MSE (smoothed with alpha=0.01): 0.4939
New best smoothed test MSE: 0.4939. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.2021
Test MSE group_1: 0.3574
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.2180
train MSE group_1: 0.3364
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 955.383423 | Likelihood -994.687805 | KL fp 4.4798 | FP STD 0.2621|
KL coef: 0.18209306240276923
Train loss (one batch): 909.3543090820312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1997
Test MSE (smoothed with alpha=0.01): 0.4909
New best smoothed test MSE: 0.4909. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.1992
Test MSE group_1: 0.2003
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1824
train MSE group_1: 0.1939
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 477.483215 | Likelihood -495.635162 | KL fp 4.9341 | FP STD 0.2075|
KL coef: 0.2602996266117198
Train loss (one batch): 500.0774841308594
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0999
Test MSE (smoothed with alpha=0.01): 0.4870
New best smoothed test MSE: 0.4870. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0912
Test MSE group_1: 0.1102
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1002
train MSE group_1: 0.1025
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 342.683746 | Likelihood -355.420593 | KL fp 5.4450 | FP STD 0.1955|
KL coef: 0.3310282414303197
Train loss (one batch): 393.1940612792969
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0718
Test MSE (smoothed with alpha=0.01): 0.4829
New best smoothed test MSE: 0.4829. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0497
Test MSE group_1: 0.0984
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0554
train MSE group_1: 0.1149
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 312.024475 | Likelihood -317.267303 | KL fp 5.1052 | FP STD 0.1480|
KL coef: 0.39499393286246365
Train loss (one batch): 321.5375671386719
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0642
Test MSE (smoothed with alpha=0.01): 0.4787
New best smoothed test MSE: 0.4787. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0434
Test MSE group_1: 0.0891
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0529
train MSE group_1: 0.0824
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 295.612427 | Likelihood -305.673798 | KL fp 5.0679 | FP STD 0.1504|
KL coef: 0.4528433576092388
Train loss (one batch): 310.2731018066406
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0619
Test MSE (smoothed with alpha=0.01): 0.4745
New best smoothed test MSE: 0.4745. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0430
Test MSE group_1: 0.0845
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0565
train MSE group_1: 0.0714
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0080 [Test seq (cond on sampled tp)] | Loss 297.688110 | Likelihood -304.709412 | KL fp 5.6327 | FP STD 0.1199|
KL coef: 0.505161340399793
Train loss (one batch): 290.6499328613281
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0617
Test MSE (smoothed with alpha=0.01): 0.4704
New best smoothed test MSE: 0.4704. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0420
Test MSE group_1: 0.0852
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0519
train MSE group_1: 0.0681
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0090 [Test seq (cond on sampled tp)] | Loss 295.672546 | Likelihood -304.214081 | KL fp 5.5525 | FP STD 0.1225|
KL coef: 0.5524767862361895
Train loss (one batch): 286.85711669921875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0616
Test MSE (smoothed with alpha=0.01): 0.4663
New best smoothed test MSE: 0.4663. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0404
Test MSE group_1: 0.0870
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0508
train MSE group_1: 0.0677
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0100 [Test seq (cond on sampled tp)] | Loss 299.539001 | Likelihood -303.268921 | KL fp 5.4146 | FP STD 0.1591|
KL coef: 0.5952680273216762
Train loss (one batch): 306.38238525390625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0614
Test MSE (smoothed with alpha=0.01): 0.4623
New best smoothed test MSE: 0.4623. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0404
Test MSE group_1: 0.0866
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0536
train MSE group_1: 0.0737
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0110 [Test seq (cond on sampled tp)] | Loss 282.229584 | Likelihood -287.678345 | KL fp 5.1876 | FP STD 0.1725|
KL coef: 0.6339676587267709
Train loss (one batch): 279.0728454589844
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0583
Test MSE (smoothed with alpha=0.01): 0.4582
New best smoothed test MSE: 0.4582. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0386
Test MSE group_1: 0.0819
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0505
train MSE group_1: 0.0663
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0120 [Test seq (cond on sampled tp)] | Loss 286.572113 | Likelihood -292.645996 | KL fp 5.1593 | FP STD 0.1654|
KL coef: 0.6689669116789861
Train loss (one batch): 296.2076416015625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0593
Test MSE (smoothed with alpha=0.01): 0.4542
New best smoothed test MSE: 0.4542. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0388
Test MSE group_1: 0.0838
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0534
train MSE group_1: 0.0686
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0130 [Test seq (cond on sampled tp)] | Loss 280.607117 | Likelihood -286.558441 | KL fp 5.3152 | FP STD 0.1877|
KL coef: 0.7006196086876687
Train loss (one batch): 294.85931396484375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0580
Test MSE (smoothed with alpha=0.01): 0.4503
New best smoothed test MSE: 0.4503. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0386
Test MSE group_1: 0.0814
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0505
train MSE group_1: 0.0723
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0140 [Test seq (cond on sampled tp)] | Loss 292.136475 | Likelihood -297.395294 | KL fp 5.6203 | FP STD 0.1647|
KL coef: 0.729245740488006
Train loss (one batch): 280.5302734375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0602
Test MSE (smoothed with alpha=0.01): 0.4464
New best smoothed test MSE: 0.4464. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0409
Test MSE group_1: 0.0833
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0500
train MSE group_1: 0.0662
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0150 [Test seq (cond on sampled tp)] | Loss 279.066895 | Likelihood -280.131073 | KL fp 5.5064 | FP STD 0.1568|
KL coef: 0.7551347009650705
Train loss (one batch): 277.3387451171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0568
Test MSE (smoothed with alpha=0.01): 0.4425
New best smoothed test MSE: 0.4425. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0369
Test MSE group_1: 0.0806
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0498
train MSE group_1: 0.0651
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0160 [Test seq (cond on sampled tp)] | Loss 269.755463 | Likelihood -278.045685 | KL fp 5.3555 | FP STD 0.1614|
KL coef: 0.7785482127611391
Train loss (one batch): 276.1588134765625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0563
Test MSE (smoothed with alpha=0.01): 0.4386
New best smoothed test MSE: 0.4386. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0369
Test MSE group_1: 0.0796
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0489
train MSE group_1: 0.0647
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0170 [Test seq (cond on sampled tp)] | Loss 270.224731 | Likelihood -277.203308 | KL fp 5.3819 | FP STD 0.1499|
KL coef: 0.7997229731425107
Train loss (one batch): 274.15228271484375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0562
Test MSE (smoothed with alpha=0.01): 0.4348
New best smoothed test MSE: 0.4348. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0365
Test MSE group_1: 0.0797
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0491
train MSE group_1: 0.0633
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0180 [Test seq (cond on sampled tp)] | Loss 274.674866 | Likelihood -277.788910 | KL fp 5.4673 | FP STD 0.1343|
KL coef: 0.8188730468740297
Train loss (one batch): 273.8641662597656
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0563
Test MSE (smoothed with alpha=0.01): 0.4310
New best smoothed test MSE: 0.4310. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0363
Test MSE group_1: 0.0803
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0476
train MSE group_1: 0.0663
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0190 [Test seq (cond on sampled tp)] | Loss 273.037445 | Likelihood -272.813049 | KL fp 5.3764 | FP STD 0.1268|
KL coef: 0.8361920302919126
Train loss (one batch): 270.03607177734375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0553
Test MSE (smoothed with alpha=0.01): 0.4272
New best smoothed test MSE: 0.4272. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0364
Test MSE group_1: 0.0780
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0489
train MSE group_1: 0.0620
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0200 [Test seq (cond on sampled tp)] | Loss 274.627472 | Likelihood -275.595764 | KL fp 5.7121 | FP STD 0.1149|
KL coef: 0.8518550084524206
Train loss (one batch): 270.8288269042969
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0559
Test MSE (smoothed with alpha=0.01): 0.4235
New best smoothed test MSE: 0.4235. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0370
Test MSE group_1: 0.0784
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0484
train MSE group_1: 0.0625
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0210 [Test seq (cond on sampled tp)] | Loss 287.137268 | Likelihood -296.703827 | KL fp 4.9014 | FP STD 0.1709|
KL coef: 0.8660203251420383
Train loss (one batch): 290.7568359375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0601
Test MSE (smoothed with alpha=0.01): 0.4199
New best smoothed test MSE: 0.4199. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0406
Test MSE group_1: 0.0835
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0534
train MSE group_1: 0.0656
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0220 [Test seq (cond on sampled tp)] | Loss 275.136597 | Likelihood -296.956116 | KL fp 4.6732 | FP STD 0.2255|
KL coef: 0.8788311836429517
Train loss (one batch): 294.1702575683594
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0601
Test MSE (smoothed with alpha=0.01): 0.4163
New best smoothed test MSE: 0.4163. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0369
Test MSE group_1: 0.0880
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0532
train MSE group_1: 0.0708
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0230 [Test seq (cond on sampled tp)] | Loss 280.262848 | Likelihood -291.474609 | KL fp 5.4309 | FP STD 0.1868|
KL coef: 0.8904170944366518
Train loss (one batch): 275.6796875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0590
Test MSE (smoothed with alpha=0.01): 0.4127
New best smoothed test MSE: 0.4127. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0407
Test MSE group_1: 0.0810
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0484
train MSE group_1: 0.0679
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0240 [Test seq (cond on sampled tp)] | Loss 274.232849 | Likelihood -279.787964 | KL fp 5.2259 | FP STD 0.1652|
KL coef: 0.9008951844811254
Train loss (one batch): 295.0010986328125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0567
Test MSE (smoothed with alpha=0.01): 0.4092
New best smoothed test MSE: 0.4092. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0389
Test MSE group_1: 0.0780
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0521
train MSE group_1: 0.0710
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0250 [Test seq (cond on sampled tp)] | Loss 270.770782 | Likelihood -273.632843 | KL fp 5.3314 | FP STD 0.1346|
KL coef: 0.9103713812976754
Train loss (one batch): 272.5697937011719
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0555
Test MSE (smoothed with alpha=0.01): 0.4056
New best smoothed test MSE: 0.4056. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0362
Test MSE group_1: 0.0786
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0507
train MSE group_1: 0.0606
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33672
Epoch 0260 [Test seq (cond on sampled tp)] | Loss 271.777740 | Likelihood -278.873718 | KL fp 5.5137 | FP STD 0.1303|
KL coef: 0.9189414838378187
Train loss (one batch): 265.67962646484375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0565
Test MSE (smoothed with alpha=0.01): 0.4021
New best smoothed test MSE: 0.4021. Saving best model to experiments/experiment_33672_best.ckpt
Test MSE group_0: 0.0383
Test MSE group_1: 0.0783
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0479
train MSE group_1: 0.0605
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['156', '159', '162', '163', '165', '166', '167', '168', '169', '170', '171', '172', '173', '174', '175', '177', '178', '179', '184', '185', '186', '187', '189', '190', '191', '192', '193', '194', '196', '197', '198', '199', '200']
163
TensorBoard logs will be saved to: experiments/runs/33672
Traceback (most recent call last):
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py", line 288, in <module>
    train_res = model.compute_all_losses(batch_dict, n_traj_samples = 3, kl_coef = kl_coef)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/base_models.py", line 261, in compute_all_losses
    pred_y, info = self.get_reconstruction(batch_dict["tp_to_predict"], 
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/latent_ode.py", line 71, in get_reconstruction
    first_point_mu, first_point_std = self.encoder_z0(
                                      ^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/encoder_decoder.py", line 233, in forward
    last_yi, last_yi_std, _, extra_info = self.run_odernn(
                                          ^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/encoder_decoder.py", line 295, in run_odernn
    ode_sol = self.z0_diffeq_solver(prev_y, time_points)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/diffeq_solver.py", line 40, in forward
    pred_y = odeint(self.ode_func, first_point, time_steps_to_predict, 
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/odeint.py", line 80, in odeint
    solution = solver.integrate(t)
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/solvers.py", line 114, in integrate
    dy, f0 = self._step_func(self.func, t0, dt, t1, y0)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/fixed_grid.py", line 10, in _step_func
    f0 = func(t0, y0, perturb=Perturb.NEXT if self.perturb else Perturb.NONE)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/misc.py", line 197, in forward
    return self.base_func(t, y)
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchdiffeq/_impl/misc.py", line 165, in forward
    return self.mul * self.base_func(-t, y)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/ode_func.py", line 36, in forward
    grad = self.get_ode_gradient_nn(t_local, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/ode_func.py", line 42, in get_ode_gradient_nn
    return self.gradient_net(y)
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/nn/modules/activation.py", line 392, in forward
    return torch.tanh(input)
           ^^^^^^^^^^^^^^^^^
KeyboardInterrupt
