/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 3000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 1 --experiment 33896
Experiment 33896
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 6371.510742 | Likelihood -6420.593750 | KL fp 1.9263 | FP STD 0.2586|
KL coef: 0.0
Train loss (one batch): 8869.70703125
Train CE loss (one batch): 0.0
Test MSE (raw): 1.2849
Test MSE (smoothed with alpha=0.01): 1.2849
New best smoothed test MSE: 1.2849. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 1.5419
Test MSE group_1: 0.9761
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 2.0937
train MSE group_1: 1.3668
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 1465.145508 | Likelihood -1549.934570 | KL fp 3.5170 | FP STD 0.6219|
KL coef: 0.09561792499119559
Train loss (one batch): 1502.676513671875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.3107
Test MSE (smoothed with alpha=0.01): 1.2751
New best smoothed test MSE: 1.2751. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.2983
Test MSE group_1: 0.3243
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.3256
train MSE group_1: 0.3064
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 986.730469 | Likelihood -1028.739014 | KL fp 5.5612 | FP STD 0.3372|
KL coef: 0.18209306240276923
Train loss (one batch): 1085.779541015625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.2065
Test MSE (smoothed with alpha=0.01): 1.2644
New best smoothed test MSE: 1.2644. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1669
Test MSE group_1: 0.2525
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1761
train MSE group_1: 0.2813
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 975.696472 | Likelihood -991.740845 | KL fp 5.4560 | FP STD 0.3520|
KL coef: 0.2602996266117198
Train loss (one batch): 1010.068359375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1991
Test MSE (smoothed with alpha=0.01): 1.2538
New best smoothed test MSE: 1.2538. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1913
Test MSE group_1: 0.2073
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1959
train MSE group_1: 0.2183
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 921.658997 | Likelihood -942.613525 | KL fp 5.8369 | FP STD 0.3032|
KL coef: 0.3310282414303197
Train loss (one batch): 991.6512451171875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1893
Test MSE (smoothed with alpha=0.01): 1.2431
New best smoothed test MSE: 1.2431. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1595
Test MSE group_1: 0.2236
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1680
train MSE group_1: 0.2411
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 912.962158 | Likelihood -936.913696 | KL fp 5.8384 | FP STD 0.2685|
KL coef: 0.39499393286246365
Train loss (one batch): 938.3143920898438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1881
Test MSE (smoothed with alpha=0.01): 1.2326
New best smoothed test MSE: 1.2326. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1690
Test MSE group_1: 0.2098
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1664
train MSE group_1: 0.2242
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 894.440125 | Likelihood -913.844482 | KL fp 5.9396 | FP STD 0.2445|
KL coef: 0.4528433576092388
Train loss (one batch): 939.9835815429688
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1835
Test MSE (smoothed with alpha=0.01): 1.2221
New best smoothed test MSE: 1.2221. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1624
Test MSE group_1: 0.2075
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1662
train MSE group_1: 0.2189
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0080 [Test seq (cond on sampled tp)] | Loss 886.417725 | Likelihood -901.170227 | KL fp 5.6540 | FP STD 0.2495|
KL coef: 0.505161340399793
Train loss (one batch): 920.8705444335938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1810
Test MSE (smoothed with alpha=0.01): 1.2117
New best smoothed test MSE: 1.2117. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1621
Test MSE group_1: 0.2023
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1632
train MSE group_1: 0.2136
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0090 [Test seq (cond on sampled tp)] | Loss 866.394348 | Likelihood -881.261230 | KL fp 5.5842 | FP STD 0.2492|
KL coef: 0.5524767862361895
Train loss (one batch): 909.453857421875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1770
Test MSE (smoothed with alpha=0.01): 1.2013
New best smoothed test MSE: 1.2013. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1561
Test MSE group_1: 0.2009
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1610
train MSE group_1: 0.2143
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0100 [Test seq (cond on sampled tp)] | Loss 845.010986 | Likelihood -856.465637 | KL fp 5.5811 | FP STD 0.2245|
KL coef: 0.5952680273216762
Train loss (one batch): 884.3145141601562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1720
Test MSE (smoothed with alpha=0.01): 1.1910
New best smoothed test MSE: 1.1910. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1520
Test MSE group_1: 0.1949
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1568
train MSE group_1: 0.2070
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0110 [Test seq (cond on sampled tp)] | Loss 805.884705 | Likelihood -827.599609 | KL fp 5.4516 | FP STD 0.2188|
KL coef: 0.6339676587267709
Train loss (one batch): 850.7041015625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1663
Test MSE (smoothed with alpha=0.01): 1.1808
New best smoothed test MSE: 1.1808. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1473
Test MSE group_1: 0.1879
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1533
train MSE group_1: 0.1952
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0120 [Test seq (cond on sampled tp)] | Loss 744.806396 | Likelihood -754.512207 | KL fp 5.2591 | FP STD 0.1884|
KL coef: 0.6689669116789861
Train loss (one batch): 783.4705810546875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1516
Test MSE (smoothed with alpha=0.01): 1.1705
New best smoothed test MSE: 1.1705. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1355
Test MSE group_1: 0.1701
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1422
train MSE group_1: 0.1791
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 33896
Epoch 0130 [Test seq (cond on sampled tp)] | Loss 617.678345 | Likelihood -624.359375 | KL fp 5.1011 | FP STD 0.1741|
KL coef: 0.7006196086876687
Train loss (one batch): 652.5084228515625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1256
Test MSE (smoothed with alpha=0.01): 1.1600
New best smoothed test MSE: 1.1600. Saving best model to experiments/experiment_33896_best.ckpt
Test MSE group_0: 0.1121
Test MSE group_1: 0.1411
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1206
train MSE group_1: 0.1474
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
