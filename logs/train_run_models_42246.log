/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/io/image.py:14: UserWarning: Failed to load image Python extension: 'dlopen(/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so, 0x0006): Library not loaded: @rpath/libjpeg.9.dylib
  Referenced from: <367D4265-B20F-34BD-94EB-4F3EE47C385B> /opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/image.so
  Reason: tried: '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torchvision/../../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/lib/python3.12/lib-dynload/../../libjpeg.9.dylib' (no such file), '/opt/miniconda3/envs/NODE_test/bin/../lib/libjpeg.9.dylib' (no such file)'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py
run_models.py --niters 3000 -n 200 -s 40 -l 10 --dataset PK_Tacro --latent-ode --noise-weight 0.01 --max-t 5. --seed 25 --experiment 42246
Experiment 42246
Epoch 0010 [Test seq (cond on sampled tp)] | Loss 1634.738525 | Likelihood -1788.027588 | KL fp 3.3540 | FP STD 0.7234|
KL coef: 0.0
Train loss (one batch): 2572.873779296875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.3583
Test MSE (smoothed with alpha=0.01): 0.3583
New best smoothed test MSE: 0.3583. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.4628
Test MSE group_1: 0.2347
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.6787
train MSE group_1: 0.3829
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0020 [Test seq (cond on sampled tp)] | Loss 881.044434 | Likelihood -907.376404 | KL fp 4.3845 | FP STD 0.5036|
KL coef: 0.09561792499119559
Train loss (one batch): 800.6238403320312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1822
Test MSE (smoothed with alpha=0.01): 0.3566
New best smoothed test MSE: 0.3566. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.1263
Test MSE group_1: 0.2490
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1165
train MSE group_1: 0.2134
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0030 [Test seq (cond on sampled tp)] | Loss 714.549927 | Likelihood -729.667603 | KL fp 4.9841 | FP STD 0.2119|
KL coef: 0.18209306240276923
Train loss (one batch): 662.5781860351562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1467
Test MSE (smoothed with alpha=0.01): 0.3545
New best smoothed test MSE: 0.3545. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.1207
Test MSE group_1: 0.1778
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1144
train MSE group_1: 0.1565
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0040 [Test seq (cond on sampled tp)] | Loss 556.818359 | Likelihood -573.244629 | KL fp 4.7059 | FP STD 0.2964|
KL coef: 0.2602996266117198
Train loss (one batch): 546.644775390625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.1154
Test MSE (smoothed with alpha=0.01): 0.3521
New best smoothed test MSE: 0.3521. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0946
Test MSE group_1: 0.1402
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.1003
train MSE group_1: 0.1211
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0050 [Test seq (cond on sampled tp)] | Loss 329.987885 | Likelihood -342.574982 | KL fp 4.4004 | FP STD 0.3393|
KL coef: 0.3310282414303197
Train loss (one batch): 357.0680847167969
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0693
Test MSE (smoothed with alpha=0.01): 0.3493
New best smoothed test MSE: 0.3493. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0541
Test MSE group_1: 0.0873
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0671
train MSE group_1: 0.0794
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0060 [Test seq (cond on sampled tp)] | Loss 278.393829 | Likelihood -287.327576 | KL fp 4.8852 | FP STD 0.3319|
KL coef: 0.39499393286246365
Train loss (one batch): 267.3625793457031
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0582
Test MSE (smoothed with alpha=0.01): 0.3464
New best smoothed test MSE: 0.3464. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0468
Test MSE group_1: 0.0717
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0428
train MSE group_1: 0.0730
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0070 [Test seq (cond on sampled tp)] | Loss 246.852432 | Likelihood -254.285156 | KL fp 4.6075 | FP STD 0.3203|
KL coef: 0.4528433576092388
Train loss (one batch): 256.86749267578125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0516
Test MSE (smoothed with alpha=0.01): 0.3434
New best smoothed test MSE: 0.3434. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0391
Test MSE group_1: 0.0665
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0439
train MSE group_1: 0.0611
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0080 [Test seq (cond on sampled tp)] | Loss 222.742065 | Likelihood -226.274658 | KL fp 4.5682 | FP STD 0.2786|
KL coef: 0.505161340399793
Train loss (one batch): 221.4701385498047
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0460
Test MSE (smoothed with alpha=0.01): 0.3404
New best smoothed test MSE: 0.3404. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0317
Test MSE group_1: 0.0630
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0387
train MSE group_1: 0.0528
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0090 [Test seq (cond on sampled tp)] | Loss 211.129623 | Likelihood -213.428864 | KL fp 4.7360 | FP STD 0.2392|
KL coef: 0.5524767862361895
Train loss (one batch): 212.6885223388672
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0434
Test MSE (smoothed with alpha=0.01): 0.3375
New best smoothed test MSE: 0.3375. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0305
Test MSE group_1: 0.0588
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0316
train MSE group_1: 0.0557
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0100 [Test seq (cond on sampled tp)] | Loss 209.792908 | Likelihood -211.125626 | KL fp 5.1088 | FP STD 0.2028|
KL coef: 0.5952680273216762
Train loss (one batch): 199.47625732421875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0430
Test MSE (smoothed with alpha=0.01): 0.3345
New best smoothed test MSE: 0.3345. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0320
Test MSE group_1: 0.0560
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0310
train MSE group_1: 0.0512
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0110 [Test seq (cond on sampled tp)] | Loss 196.845032 | Likelihood -197.088272 | KL fp 5.1177 | FP STD 0.1712|
KL coef: 0.6339676587267709
Train loss (one batch): 196.78501892089844
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0402
Test MSE (smoothed with alpha=0.01): 0.3316
New best smoothed test MSE: 0.3316. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0276
Test MSE group_1: 0.0550
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0308
train MSE group_1: 0.0496
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0120 [Test seq (cond on sampled tp)] | Loss 196.303726 | Likelihood -198.203369 | KL fp 5.0909 | FP STD 0.1617|
KL coef: 0.6689669116789861
Train loss (one batch): 192.67282104492188
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0404
Test MSE (smoothed with alpha=0.01): 0.3287
New best smoothed test MSE: 0.3287. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0273
Test MSE group_1: 0.0559
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0278
train MSE group_1: 0.0511
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0130 [Test seq (cond on sampled tp)] | Loss 195.642242 | Likelihood -197.248978 | KL fp 4.8663 | FP STD 0.1833|
KL coef: 0.7006196086876687
Train loss (one batch): 191.5867156982422
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0402
Test MSE (smoothed with alpha=0.01): 0.3258
New best smoothed test MSE: 0.3258. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0283
Test MSE group_1: 0.0543
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0288
train MSE group_1: 0.0494
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0140 [Test seq (cond on sampled tp)] | Loss 199.102203 | Likelihood -198.538330 | KL fp 5.2031 | FP STD 0.1851|
KL coef: 0.729245740488006
Train loss (one batch): 188.6395721435547
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0404
Test MSE (smoothed with alpha=0.01): 0.3229
New best smoothed test MSE: 0.3229. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0276
Test MSE group_1: 0.0557
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0272
train MSE group_1: 0.0500
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0150 [Test seq (cond on sampled tp)] | Loss 192.222290 | Likelihood -193.287994 | KL fp 4.9741 | FP STD 0.1700|
KL coef: 0.7551347009650705
Train loss (one batch): 190.09426879882812
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0394
Test MSE (smoothed with alpha=0.01): 0.3201
New best smoothed test MSE: 0.3201. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0277
Test MSE group_1: 0.0534
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0285
train MSE group_1: 0.0489
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0160 [Test seq (cond on sampled tp)] | Loss 188.093567 | Likelihood -187.412231 | KL fp 5.3289 | FP STD 0.1474|
KL coef: 0.7785482127611391
Train loss (one batch): 185.95303344726562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0382
Test MSE (smoothed with alpha=0.01): 0.3173
New best smoothed test MSE: 0.3173. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0273
Test MSE group_1: 0.0512
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0281
train MSE group_1: 0.0477
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0170 [Test seq (cond on sampled tp)] | Loss 185.274750 | Likelihood -184.138153 | KL fp 5.4817 | FP STD 0.1322|
KL coef: 0.7997229731425107
Train loss (one batch): 183.59652709960938
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0376
Test MSE (smoothed with alpha=0.01): 0.3145
New best smoothed test MSE: 0.3145. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0258
Test MSE group_1: 0.0516
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0277
train MSE group_1: 0.0472
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0180 [Test seq (cond on sampled tp)] | Loss 188.259216 | Likelihood -188.067993 | KL fp 5.0562 | FP STD 0.1603|
KL coef: 0.8188730468740297
Train loss (one batch): 186.21951293945312
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0384
Test MSE (smoothed with alpha=0.01): 0.3117
New best smoothed test MSE: 0.3117. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0270
Test MSE group_1: 0.0519
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0283
train MSE group_1: 0.0483
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0190 [Test seq (cond on sampled tp)] | Loss 183.896744 | Likelihood -183.977127 | KL fp 5.2992 | FP STD 0.1291|
KL coef: 0.8361920302919126
Train loss (one batch): 184.3918914794922
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0375
Test MSE (smoothed with alpha=0.01): 0.3090
New best smoothed test MSE: 0.3090. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0263
Test MSE group_1: 0.0509
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0279
train MSE group_1: 0.0468
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0200 [Test seq (cond on sampled tp)] | Loss 185.920654 | Likelihood -185.564301 | KL fp 4.9204 | FP STD 0.1563|
KL coef: 0.8518550084524206
Train loss (one batch): 186.3251190185547
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0379
Test MSE (smoothed with alpha=0.01): 0.3063
New best smoothed test MSE: 0.3063. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0267
Test MSE group_1: 0.0510
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0278
train MSE group_1: 0.0482
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0210 [Test seq (cond on sampled tp)] | Loss 182.270035 | Likelihood -180.846054 | KL fp 5.1450 | FP STD 0.1328|
KL coef: 0.8660203251420383
Train loss (one batch): 180.7957305908203
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0369
Test MSE (smoothed with alpha=0.01): 0.3036
New best smoothed test MSE: 0.3036. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0257
Test MSE group_1: 0.0503
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0267
train MSE group_1: 0.0466
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0220 [Test seq (cond on sampled tp)] | Loss 181.718307 | Likelihood -180.389893 | KL fp 5.3059 | FP STD 0.1243|
KL coef: 0.8788311836429517
Train loss (one batch): 179.12152099609375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0368
Test MSE (smoothed with alpha=0.01): 0.3009
New best smoothed test MSE: 0.3009. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0260
Test MSE group_1: 0.0497
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0263
train MSE group_1: 0.0463
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0230 [Test seq (cond on sampled tp)] | Loss 182.044128 | Likelihood -181.314026 | KL fp 5.0413 | FP STD 0.1344|
KL coef: 0.8904170944366518
Train loss (one batch): 178.39364624023438
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0370
Test MSE (smoothed with alpha=0.01): 0.2983
New best smoothed test MSE: 0.2983. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0260
Test MSE group_1: 0.0501
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0262
train MSE group_1: 0.0462
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0240 [Test seq (cond on sampled tp)] | Loss 179.832886 | Likelihood -178.503021 | KL fp 5.1650 | FP STD 0.1276|
KL coef: 0.9008951844811254
Train loss (one batch): 178.22747802734375
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0364
Test MSE (smoothed with alpha=0.01): 0.2956
New best smoothed test MSE: 0.2956. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0255
Test MSE group_1: 0.0494
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0265
train MSE group_1: 0.0457
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0250 [Test seq (cond on sampled tp)] | Loss 179.791122 | Likelihood -177.889526 | KL fp 5.3634 | FP STD 0.1144|
KL coef: 0.9103713812976754
Train loss (one batch): 176.03506469726562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0363
Test MSE (smoothed with alpha=0.01): 0.2930
New best smoothed test MSE: 0.2930. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0255
Test MSE group_1: 0.0491
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0260
train MSE group_1: 0.0454
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0260 [Test seq (cond on sampled tp)] | Loss 178.628311 | Likelihood -176.829971 | KL fp 5.3715 | FP STD 0.1111|
KL coef: 0.9189414838378187
Train loss (one batch): 175.67266845703125
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0361
Test MSE (smoothed with alpha=0.01): 0.2905
New best smoothed test MSE: 0.2905. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0256
Test MSE group_1: 0.0485
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0262
train MSE group_1: 0.0450
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0270 [Test seq (cond on sampled tp)] | Loss 179.358978 | Likelihood -177.686676 | KL fp 5.0342 | FP STD 0.1329|
KL coef: 0.9266921309561118
Train loss (one batch): 176.4667205810547
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0363
Test MSE (smoothed with alpha=0.01): 0.2879
New best smoothed test MSE: 0.2879. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0255
Test MSE group_1: 0.0490
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0261
train MSE group_1: 0.0454
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0280 [Test seq (cond on sampled tp)] | Loss 177.345032 | Likelihood -175.943939 | KL fp 5.1815 | FP STD 0.1327|
KL coef: 0.9337016772796147
Train loss (one batch): 175.94586181640625
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0359
Test MSE (smoothed with alpha=0.01): 0.2854
New best smoothed test MSE: 0.2854. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0257
Test MSE group_1: 0.0481
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0265
train MSE group_1: 0.0448
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0290 [Test seq (cond on sampled tp)] | Loss 178.082077 | Likelihood -176.539230 | KL fp 5.2500 | FP STD 0.1262|
KL coef: 0.9400409853285345
Train loss (one batch): 174.7058563232422
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0360
Test MSE (smoothed with alpha=0.01): 0.2829
New best smoothed test MSE: 0.2829. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0257
Test MSE group_1: 0.0483
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0260
train MSE group_1: 0.0449
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0300 [Test seq (cond on sampled tp)] | Loss 177.504395 | Likelihood -175.633438 | KL fp 5.2138 | FP STD 0.1185|
KL coef: 0.9457741418959368
Train loss (one batch): 174.78187561035156
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0359
Test MSE (smoothed with alpha=0.01): 0.2804
New best smoothed test MSE: 0.2804. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0255
Test MSE group_1: 0.0482
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0259
train MSE group_1: 0.0448
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0310 [Test seq (cond on sampled tp)] | Loss 177.212738 | Likelihood -175.385727 | KL fp 5.2257 | FP STD 0.1134|
KL coef: 0.9509591059287142
Train loss (one batch): 175.41152954101562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0358
Test MSE (smoothed with alpha=0.01): 0.2780
New best smoothed test MSE: 0.2780. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0255
Test MSE group_1: 0.0481
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0260
train MSE group_1: 0.0449
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0320 [Test seq (cond on sampled tp)] | Loss 177.333435 | Likelihood -175.440704 | KL fp 5.1708 | FP STD 0.1115|
KL coef: 0.9556482944595236
Train loss (one batch): 174.82608032226562
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0358
Test MSE (smoothed with alpha=0.01): 0.2756
New best smoothed test MSE: 0.2756. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0256
Test MSE group_1: 0.0480
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0266
train MSE group_1: 0.0440
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0330 [Test seq (cond on sampled tp)] | Loss 176.374115 | Likelihood -174.220856 | KL fp 5.3147 | FP STD 0.1159|
KL coef: 0.9598891125131245
Train loss (one batch): 175.3124542236328
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0356
Test MSE (smoothed with alpha=0.01): 0.2732
New best smoothed test MSE: 0.2732. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0250
Test MSE group_1: 0.0481
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0260
train MSE group_1: 0.0449
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0340 [Test seq (cond on sampled tp)] | Loss 180.415497 | Likelihood -178.582611 | KL fp 5.1787 | FP STD 0.1373|
KL coef: 0.9637244323441748
Train loss (one batch): 176.73240661621094
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0365
Test MSE (smoothed with alpha=0.01): 0.2708
New best smoothed test MSE: 0.2708. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0266
Test MSE group_1: 0.0481
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0269
train MSE group_1: 0.0445
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0350 [Test seq (cond on sampled tp)] | Loss 177.565918 | Likelihood -175.403152 | KL fp 5.2605 | FP STD 0.1148|
KL coef: 0.9671930268513026
Train loss (one batch): 173.77655029296875
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0358
Test MSE (smoothed with alpha=0.01): 0.2685
New best smoothed test MSE: 0.2685. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0254
Test MSE group_1: 0.0482
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0254
train MSE group_1: 0.0448
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0360 [Test seq (cond on sampled tp)] | Loss 176.308472 | Likelihood -174.048767 | KL fp 5.2766 | FP STD 0.1124|
KL coef: 0.9703299615490228
Train loss (one batch): 173.94137573242188
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0355
Test MSE (smoothed with alpha=0.01): 0.2661
New best smoothed test MSE: 0.2661. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0258
Test MSE group_1: 0.0471
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0259
train MSE group_1: 0.0443
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Experiment 42246
Epoch 0370 [Test seq (cond on sampled tp)] | Loss 175.863251 | Likelihood -174.070877 | KL fp 5.1174 | FP STD 0.1233|
KL coef: 0.9731669490601144
Train loss (one batch): 174.5467071533203
Train CE loss (one batch): 0.0
Test MSE (raw): 0.0356
Test MSE (smoothed with alpha=0.01): 0.2638
New best smoothed test MSE: 0.2638. Saving best model to experiments/experiment_42246_best.ckpt
Test MSE group_0: 0.0259
Test MSE group_1: 0.0471
Test MSE group_2: nan
Test MSE group_3: nan
Poisson likelihood: 0.0
CE loss: 0.0
train MSE group_0: 0.0262
train MSE group_1: 0.0443
train MSE group_2: nan
train MSE group_3: nan
CE loss (TEST): 0.0
Couldn't import umap
Sampling dataset of 200 training examples
############## ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '211', '212', '213', '214', '215', '216', '217', '218', '219', '220', '221', '222', '223', '224', '225', '226', '227', '228', '229', '230', '231', '232', '233', '234', '235', '236', '237', '238', '239', '240', '241', '242', '243', '244', '245', '246', '247', '248', '249', '250', '251', '252', '253', '254', '255', '256', '257', '258', '259', '260', '261', '262', '263', '264', '265', '266', '267', '268', '269', '270', '271', '272', '273', '274', '275', '276', '277', '278', '279', '280', '281', '282', '283', '284', '285', '286', '287', '288', '289', '290', '291', '292', '293', '294', '295', '296', '297', '298', '299', '300', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '311', '312', '313', '314', '315', '316', '317', '318', '319', '320', '321', '322', '323', '324', '325', '326', '327', '328', '329', '330', '331', '332', '333', '334', '335', '336', '337', '338', '339', '340', '341', '342', '343', '344', '345', '346', '347', '348', '349', '350', '351', '352', '353', '354', '355', '356', '357', '358', '359', '360', '361', '362', '363', '364', '365', '366', '367', '368', '369', '370', '371', '372', '373', '374', '375', '376', '377', '378', '379', '380', '381', '382', '383', '384', '385', '386', '387', '388', '389', '390', '391', '392', '393', '394', '395', '396', '397', '398', '399', '400', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '411', '412', '413', '414', '415', '416', '417', '418', '419', '420', '421', '422', '423', '424', '425', '426', '427', '428', '429', '430', '431', '432', '433', '434', '435', '436', '437', '438', '439', '440', '441', '442', '443', '444', '445', '446', '447', '448', '449', '450', '451', '452', '453', '454', '455', '456', '457', '458', '459', '460', '461', '462', '463', '464', '465', '466', '467', '468', '469', '470', '471', '472', '473', '474', '475', '476', '477', '478', '479', '480', '481', '482', '483', '484', '485', '486', '487', '488', '489', '490', '491', '492', '493', '494', '495', '496', '497', '498', '499', '500', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510', '511', '512', '513', '514', '515', '516', '517', '518', '519', '520', '521', '522', '523', '524', '525', '526', '527', '528', '529', '530', '531', '532', '533', '534', '535', '536', '537', '538', '539', '540', '541', '542', '543', '544', '545', '546', '547', '548', '549', '550', '551', '552', '553', '554', '555', '556', '557', '558', '559', '560', '561', '562', '563', '564', '565', '566', '567', '568', '569', '570', '571', '572', '573', '574', '575', '576', '577', '578', '579', '580', '581', '582', '583', '584', '585', '586', '587', '588', '589', '590', '591', '592', '593', '594', '595', '596', '597', '598', '599', '600', '601', '602', '603', '604', '605', '606', '607', '608', '609', '610', '611', '612', '613', '614', '615', '616', '617', '618', '619', '620', '621', '622', '623', '624', '625', '626', '627', '628', '629', '630', '631', '632', '633', '634', '635', '636', '637', '638', '639', '640', '641', '642', '643', '644', '645', '646', '647', '648', '649', '650', '651', '652', '653', '654', '655', '656', '657', '658', '659', '660', '661', '662', '663', '664', '665', '666', '667', '668', '669', '670', '671', '672', '673', '674', '675', '676', '677', '678', '679', '680', '681', '682', '683', '684', '685', '686', '687', '688', '689', '690', '691', '692', '693', '694', '695', '696', '697', '698', '699', '700', '701', '702', '703', '704', '705', '706', '707', '708', '709', '710', '711', '712', '713', '714', '715', '716', '717', '718', '719', '720', '721', '722', '723', '724', '725', '726', '727', '728', '729', '730', '731', '732', '733', '734', '735', '736', '737', '738', '739', '740', '741', '742', '743', '744', '745', '746', '747', '748', '749', '750', '751', '752', '753', '754', '755', '756', '757', '758', '759', '760', '761', '762', '763', '764', '765', '766', '767', '768', '769', '770', '771', '772', '773', '774', '775', '776', '777', '778', '779', '780', '781', '782', '783', '784', '785', '786', '787', '788', '789', '790', '791', '792', '793', '794', '795', '796', '797', '798', '799', '800', '801', '802', '803', '804', '805', '806', '807', '808', '809', '810', '811', '812', '813', '814', '815', '816', '817', '818', '819', '820', '821', '822', '823', '824', '825', '826', '827', '828', '829', '830', '831', '832', '833', '834', '835', '836', '837', '838', '839', '840', '841', '842', '843', '844', '845', '846', '847', '848', '849', '850', '851', '852', '853', '854', '855', '856', '857', '858', '859', '860', '861', '862', '863', '864', '865', '866', '867', '868', '869', '870', '871', '872', '873', '874', '875', '876', '877', '878', '879', '880', '881', '882', '883', '884', '885', '886', '887', '888', '889', '890', '891', '892', '893', '894', '895', '896', '897', '898', '899', '900', '901', '902', '903', '904', '905', '906', '907', '908', '909', '910', '911', '912', '913', '914', '915', '916', '917', '918', '919', '920', '921', '922', '923', '924', '925', '926', '927', '928', '929', '930', '931', '932', '933', '934', '935', '936', '937', '938', '939', '940', '941', '942', '943', '944', '945', '946', '947', '948', '949', '950', '951', '952', '953', '954', '955', '956', '957', '958', '959', '960', '961', '962', '963', '964', '965', '966', '967', '968', '969', '970', '971', '972', '973', '974', '975', '976', '977', '978', '979', '980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990', '991', '992', '993', '994', '995', '996', '997', '998', '999', '1000']
1000
TensorBoard logs will be saved to: experiments/runs/42246
Traceback (most recent call last):
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/run_models.py", line 288, in <module>
    train_res = model.compute_all_losses(batch_dict, n_traj_samples = 3, kl_coef = kl_coef)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/benjaminmaurel/Documents/Training_Sanofi/notebooks_hands_on/latent_ode/lib/base_models.py", line 303, in compute_all_losses
    fp_distr = Normal(fp_mu, fp_std)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/distributions/normal.py", line 59, in __init__
    super().__init__(batch_shape, validate_args=validate_args)
  File "/opt/miniconda3/envs/NODE_test/lib/python3.12/site-packages/torch/distributions/distribution.py", line 71, in __init__
    raise ValueError(
ValueError: Expected parameter scale (Tensor of shape (1, 200, 10)) of distribution Normal(loc: torch.Size([1, 200, 10]), scale: torch.Size([1, 200, 10])) to satisfy the constraint GreaterThan(lower_bound=0.0), but found invalid values:
tensor([[[0.0424, 0.3720, 0.0931,  ..., 0.1486, 0.0935, 0.2381],
         [0.0451, 0.4114, 0.0748,  ..., 0.1441, 0.1163, 0.2869],
         [0.1134, 0.2429, 0.0040,  ..., 0.1003, 0.1888, 0.3113],
         ...,
         [0.0317, 0.3515, 0.0802,  ..., 0.1484, 0.0758, 0.2185],
         [0.1022, 0.1761, 0.0311,  ..., 0.1158, 0.1636, 0.2470],
         [0.0123, 0.0540, 0.0416,  ..., 0.1143, 0.0561, 0.0816]]],
       grad_fn=<AbsBackward0>)
